<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Cos-ruby-sdk by RaymondChou</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Cos-ruby-sdk</h1>
      <h2 class="project-tagline">Tencent COS(Cloud Object Service) Ruby SDK</h2>
      <a href="https://github.com/RaymondChou/cos-ruby-sdk" class="btn">View on GitHub</a>
      <a href="https://github.com/RaymondChou/cos-ruby-sdk/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/RaymondChou/cos-ruby-sdk/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="tencent-cos-ruby-sdk" class="anchor" href="#tencent-cos-ruby-sdk" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tencent COS Ruby SDK</h1>

<p><a href="https://badge.fury.io/rb/cos"><img src="https://badge.fury.io/rb/cos.svg" alt="Gem Version"></a> <a href="https://gemnasium.com/RaymondChou/cos-ruby-sdk"><img src="https://gemnasium.com/RaymondChou/cos-ruby-sdk.svg" alt="Dependency Status"></a>
 <a href="https://codeclimate.com/github/RaymondChou/cos-ruby-sdk"><img src="https://codeclimate.com/github/RaymondChou/cos-ruby-sdk/badges/gpa.svg" alt="Code Climate"></a> <a href="https://travis-ci.org/RaymondChou/cos-ruby-sdk"><img src="https://travis-ci.org/RaymondChou/cos-ruby-sdk.svg?branch=master" alt="Build Status"></a> <a href="https://codeclimate.com/github/RaymondChou/cos-ruby-sdk/coverage"><img src="https://codeclimate.com/github/RaymondChou/cos-ruby-sdk/badges/coverage.svg" alt="Test Coverage"></a></p>

<p><a href="https://gitter.im/RaymondChou/cos-ruby-sdk?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge"><img src="https://badges.gitter.im/RaymondChou/cos-ruby-sdk.svg" alt="Gitter"></a> <a href="https://rubygems.org/gems/cos"><img src="http://ruby-gem-downloads-badge.herokuapp.com/cos?type=total" alt="Gem Downloads"></a> <a href="https://github.com/RaymondChou/cos-ruby-sdk"><img src="http://img.shields.io/badge/github-code-blue.svg" alt="Github Code"></a> <a href="http://rubydoc.info/github/RaymondChou/cos-ruby-sdk"><img src="http://img.shields.io/badge/yard-docs-blue.svg" alt="Yard Docs"></a></p>

<hr>

<p>Tencent<g-emoji alias="penguin" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f427.png">ğŸ§</g-emoji> COS(Cloud Object Service) SDK for Ruby  <a href="http://wiki.qcloud.com/wiki/COS%E4%BA%A7%E5%93%81%E4%BB%8B%E7%BB%8D">è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨æœåŠ¡</a></p>

<ul>
<li><p>100%å®ç°COSå®˜æ–¹Restful API</p></li>
<li><p>ç¬¦åˆRubyä½¿ç”¨ä¹ æƒ¯çš„é“¾å¼æ“ä½œ</p></li>
<li><p>æ”¯æŒHTTPS</p></li>
<li><p>æ”¯æŒå¤§æ–‡ä»¶è‡ªåŠ¨å¤šçº¿ç¨‹åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸Šä¼ ã€ä¸‹è½½</p></li>
<li><p>æ”¯æŒRails</p></li>
<li>
<p>æä¾›ä¾¿æ·çš„<a href="#6-cli%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7">CLIå·¥å…·:</a></p>

<p><img src="http://mytest-10016219.file.myqcloud.com/out2.gif" alt="CLIç¤ºä¾‹"></p>
</li>
</ul>

<p><strong>ç›®å½•</strong></p>

<ul>
<li>
<a href="#tencent-cos-ruby-sdk">Tencent COS Ruby SDK</a>

<ul>
<li><a href="#1-%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83">1 è¿è¡Œç¯å¢ƒ</a></li>
<li><a href="#2-%E5%AE%89%E8%A3%85sdk">2 å®‰è£…SDK</a></li>
<li>
<a href="#3-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8">3 å¿«é€Ÿå…¥é—¨</a>

<ul>
<li><a href="#31-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">3.1 å‡†å¤‡å·¥ä½œ</a></li>
<li><a href="#32-%E5%88%9D%E5%A7%8B%E5%8C%96">3.2 åˆå§‹åŒ–</a></li>
<li><a href="#33-%E6%8C%87%E5%AE%9Abucket">3.3 æŒ‡å®šBucket</a></li>
<li><a href="#34-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B">3.4 ç›®å½•æ“ä½œç¤ºä¾‹</a></li>
<li><a href="#35-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B">3.5 æ–‡ä»¶æ“ä½œç¤ºä¾‹</a></li>
</ul>
</li>
<li>
<a href="#4-sdk%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E">4 SDKè¯¦ç»†è¯´æ˜</a>

<ul>
<li><a href="#41-%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E9%85%8D%E7%BD%AE">4.1 åˆå§‹åŒ–ä¸é…ç½®</a></li>
<li><a href="#42-%E6%8C%87%E5%AE%9Abucket">4.2 æŒ‡å®šBucket</a></li>
<li>
<a href="#43-bucket%E6%93%8D%E4%BD%9C%EF%BC%88cosbucket%EF%BC%89">4.3 Bucketæ“ä½œï¼ˆCOS::Bucketï¼‰</a>

<ul>
<li><a href="#431-%E8%8E%B7%E5%8F%96bucket%E5%B1%9E%E6%80%A7">4.3.1 è·å–Bucketå±æ€§</a></li>
<li><a href="#432-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%EF%BC%88create_folder%EF%BC%8Cmkdir%EF%BC%89">4.3.2 åˆ›å»ºç›®å½•ï¼ˆcreate_folderï¼Œmkdirï¼‰</a></li>
<li><a href="#433-%E5%88%97%E4%B8%BE%E7%9B%AE%E5%BD%95%EF%BC%88list%EF%BC%8Cls%EF%BC%89">4.3.3 åˆ—ä¸¾ç›®å½•ï¼ˆlistï¼Œlsï¼‰</a></li>
<li><a href="#434-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%88upload%EF%BC%89">4.3.4 ä¸Šä¼ æ–‡ä»¶ï¼ˆuploadï¼‰</a></li>
<li><a href="#434-%E8%B5%84%E6%BA%90%E5%B1%9E%E6%80%A7%EF%BC%88stat%EF%BC%89">4.3.4 èµ„æºå±æ€§ï¼ˆstatï¼‰</a></li>
<li><a href="#435-%E6%9B%B4%E6%96%B0%E8%B5%84%E6%BA%90%E5%B1%9E%E6%80%A7%EF%BC%88upadte%EF%BC%89">4.3.5 æ›´æ–°èµ„æºå±æ€§ï¼ˆupadteï¼‰</a></li>
<li><a href="#436-%E5%88%A0%E9%99%A4%E8%B5%84%E6%BA%90%EF%BC%88delete%EF%BC%89">4.3.6 åˆ é™¤èµ„æºï¼ˆdeleteï¼‰</a></li>
<li><a href="#437-%E5%88%A0%E9%99%A4%E8%B5%84%E6%BA%90%EF%BC%88%E6%97%A0%E5%BC%82%E5%B8%B8%EF%BC%89%EF%BC%88delete%EF%BC%89">4.3.7 åˆ é™¤èµ„æºï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</a></li>
<li><a href="#438-%E5%88%A4%E6%96%AD%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA%EF%BC%88empty%EF%BC%89">4.3.8 åˆ¤æ–­ç›®å½•æ˜¯å¦ä¸ºç©ºï¼ˆempty?ï¼‰</a></li>
<li><a href="#439-%E5%88%A4%E6%96%AD%E8%B5%84%E6%BA%90%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%EF%BC%88exist%EF%BC%8Cexists%EF%BC%89">4.3.9 åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</a></li>
<li><a href="#439-%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%8A%E4%BC%A0%E5%AE%8C%E6%88%90%EF%BC%88complete%EF%BC%89">4.3.9 åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆï¼ˆcomplete?ï¼‰</a></li>
<li><a href="#4310-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AEurl%EF%BC%88url%EF%BC%89">4.3.10 è·å–æ–‡ä»¶çš„è®¿é—®URLï¼ˆurlï¼‰</a></li>
<li><a href="#4311-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%EF%BC%88download%EF%BC%89">4.3.11 ä¸‹è½½æ–‡ä»¶ï¼ˆdownloadï¼‰</a></li>
<li><a href="#4312-%E8%8E%B7%E5%8F%96object%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%EF%BC%88tree%EF%BC%89">4.3.12 è·å–Objectæ ‘å½¢ç»“æ„ï¼ˆtreeï¼‰</a></li>
<li><a href="#4313-%E8%8E%B7%E5%8F%96hash%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%EF%BC%88hash_tree%EF%BC%89">4.3.13 è·å–Hashæ ‘å½¢ç»“æ„ï¼ˆhash_treeï¼‰</a></li>
<li><a href="#4314-%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%EF%BC%88download_all%EF%BC%89">4.3.14 æ‰¹é‡ä¸‹è½½ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆdownload_allï¼‰</a></li>
<li><a href="#4315-%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%EF%BC%88upload_all%EF%BC%89">4.3.15 æ‰¹é‡ä¸Šä¼ ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆupload_allï¼‰</a></li>
<li><a href="#4316-%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%E8%AF%A6%E6%83%85%EF%BC%88%E6%94%AF%E6%8C%81%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2%EF%BC%89%EF%BC%88list_count%EF%BC%89">4.3.16 è·å–èµ„æºä¸ªæ•°è¯¦æƒ…ï¼ˆæ”¯æŒå‰ç¼€æœç´¢ï¼‰ï¼ˆlist_countï¼‰</a></li>
<li><a href="#4317-%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%EF%BC%88count-size%EF%BC%89">4.3.17 è·å–èµ„æºä¸ªæ•°ï¼ˆcount, sizeï¼‰</a></li>
<li><a href="#4318-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E4%B8%AA%E6%95%B0%EF%BC%88count_files%EF%BC%89">4.3.18 è·å–æ–‡ä»¶ä¸ªæ•°ï¼ˆcount_filesï¼‰</a></li>
<li><a href="#4319-%E8%8E%B7%E5%8F%96%E7%9B%AE%E5%BD%95%E4%B8%AA%E6%95%B0%EF%BC%88count_dirs%EF%BC%89">4.3.19 è·å–ç›®å½•ä¸ªæ•°ï¼ˆcount_dirsï¼‰</a></li>
</ul>
</li>
<li>
<a href="#44-%E8%B5%84%E6%BA%90%E6%93%8D%E4%BD%9C">4.4 èµ„æºæ“ä½œ</a>

<ul>
<li>
<a href="#441-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%EF%BC%88coscosfile%EF%BC%89">4.4.1 æ–‡ä»¶æ“ä½œï¼ˆCOS::COSFileï¼‰</a>

<ul>
<li><a href="#4411-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7">4.4.1.1 è·å–æ–‡ä»¶å±æ€§</a></li>
<li><a href="#4412-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%EF%BC%88%E5%88%B7%E6%96%B0%EF%BC%89%EF%BC%88stat%EF%BC%89">4.4.1.2 è·å–å½“å‰æ–‡ä»¶å±æ€§ï¼ˆåˆ·æ–°ï¼‰ï¼ˆstatï¼‰</a></li>
<li><a href="#4413-%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%EF%BC%88upadte%EF%BC%89">4.4.1.3 æ›´æ–°å½“å‰æ–‡ä»¶å±æ€§ï¼ˆupadteï¼‰</a></li>
<li><a href="#4414-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%EF%BC%88delete%EF%BC%89">4.4.1.4 åˆ é™¤å½“å‰æ–‡ä»¶ï¼ˆdeleteï¼‰</a></li>
<li><a href="#4415-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%EF%BC%88%E6%97%A0%E5%BC%82%E5%B8%B8%EF%BC%89%EF%BC%88delete%EF%BC%89">4.4.1.5 åˆ é™¤å½“å‰æ–‡ä»¶ï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</a></li>
<li><a href="#4416-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%EF%BC%88exist%EF%BC%8Cexists%EF%BC%89">4.4.1.6 åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</a></li>
<li><a href="#4417-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%8A%E4%BC%A0%E5%AE%8C%E6%88%90%EF%BC%88complete%EF%BC%89">4.4.1.7 åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆï¼ˆcomplete?ï¼‰</a></li>
<li><a href="#4418-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AEurl%EF%BC%88url%EF%BC%89">4.4.1.8 è·å–å½“å‰æ–‡ä»¶çš„è®¿é—®URLï¼ˆurlï¼‰</a></li>
<li><a href="#4419-%E4%B8%8B%E8%BD%BD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%EF%BC%88download%EF%BC%89">4.4.1.9 ä¸‹è½½å½“å‰æ–‡ä»¶ï¼ˆdownloadï¼‰</a></li>
<li><a href="#44110-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E7%9B%B8%E5%90%8C">4.4.1.10 åˆ¤æ–­å½“å‰æ–‡ä»¶ä¸æœ¬åœ°æ–‡ä»¶æ˜¯å¦ç›¸åŒ</a></li>
</ul>
</li>
<li>
<a href="#442-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%EF%BC%88coscosdir%EF%BC%89">4.4.2 ç›®å½•æ“ä½œï¼ˆCOS::COSDirï¼‰</a>

<ul>
<li><a href="#4421-%E8%8E%B7%E5%8F%96%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7">4.4.2.1 è·å–ç›®å½•å±æ€§</a></li>
<li><a href="#4422-%E5%88%97%E4%B8%BE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%EF%BC%88%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2%EF%BC%89%EF%BC%88list%EF%BC%8Cls%EF%BC%89">4.4.2.2 åˆ—ä¸¾å½“å‰ç›®å½•ï¼ˆå‰ç¼€æœç´¢ï¼‰ï¼ˆlistï¼Œlsï¼‰</a></li>
<li><a href="#4423-%E5%88%9B%E5%BB%BA%E5%AD%90%E7%9B%AE%E5%BD%95%EF%BC%88create_folder%EF%BC%8Cmkdir%EF%BC%89">4.4.2.3 åˆ›å»ºå­ç›®å½•ï¼ˆcreate_folderï¼Œmkdirï¼‰</a></li>
<li><a href="#4424-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E8%87%B3%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%EF%BC%88upload%EF%BC%89">4.4.2.4 ä¸Šä¼ æ–‡ä»¶è‡³å½“å‰ç›®å½•ï¼ˆuploadï¼‰</a></li>
<li><a href="#4425-%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E6%9C%AC%E5%9C%B0%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E8%87%B3%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%EF%BC%88upload_all%EF%BC%89">4.4.2.5 æ‰¹é‡ä¸Šä¼ æœ¬åœ°ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶è‡³å½“å‰ç›®å½•ï¼ˆupload_allï¼‰</a></li>
<li><a href="#4426-%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%EF%BC%88download_all%EF%BC%89">4.4.2.6 æ‰¹é‡ä¸‹è½½å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆdownload_allï¼‰</a></li>
<li><a href="#4427-%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7%EF%BC%88%E5%88%B7%E6%96%B0%EF%BC%89%EF%BC%88stat%EF%BC%89">4.4.2.7 å½“å‰ç›®å½•å±æ€§ï¼ˆåˆ·æ–°ï¼‰ï¼ˆstatï¼‰</a></li>
<li><a href="#4428-%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7%EF%BC%88upadte%EF%BC%89">4.4.2.8 æ›´æ–°å½“å‰ç›®å½•å±æ€§ï¼ˆupadteï¼‰</a></li>
<li><a href="#4429-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%EF%BC%88delete%EF%BC%89">4.4.2.9 åˆ é™¤å½“å‰ç›®å½•ï¼ˆdeleteï¼‰</a></li>
<li><a href="#44210-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%EF%BC%88%E6%97%A0%E5%BC%82%E5%B8%B8%EF%BC%89%EF%BC%88delete%EF%BC%89">4.4.2.10 åˆ é™¤å½“å‰ç›®å½•ï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</a></li>
<li><a href="#44211-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA%EF%BC%88empty%EF%BC%89">4.4.2.11 åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦ä¸ºç©ºï¼ˆempty?ï¼‰</a></li>
<li><a href="#44212-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%EF%BC%88exist%EF%BC%8Cexists%EF%BC%89">4.4.2.12 åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</a></li>
<li><a href="#44213-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84object%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%EF%BC%88tree%EF%BC%89">4.4.2.13 è·å–å½“å‰ç›®å½•ä¸‹çš„Objectæ ‘å½¢ç»“æ„ï¼ˆtreeï¼‰</a></li>
<li><a href="#44214-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84hash%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%EF%BC%88hash_tree%EF%BC%89">4.4.2.14 è·å–å½“å‰ç›®å½•ä¸‹çš„Hashæ ‘å½¢ç»“æ„ï¼ˆhash_treeï¼‰</a></li>
<li><a href="#44215-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%E8%AF%A6%E6%83%85%EF%BC%88%E6%94%AF%E6%8C%81%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2%EF%BC%89%EF%BC%88list_count%EF%BC%89">4.4.2.15 è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°è¯¦æƒ…ï¼ˆæ”¯æŒå‰ç¼€æœç´¢ï¼‰ï¼ˆlist_countï¼‰</a></li>
<li><a href="#44216-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%EF%BC%88count-size%EF%BC%89">4.4.2.16 è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°ï¼ˆcount, sizeï¼‰</a></li>
<li><a href="#44217-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%AA%E6%95%B0%EF%BC%88count_files%EF%BC%89">4.4.2.17 è·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°ï¼ˆcount_filesï¼‰</a></li>
<li><a href="#44218-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E5%AD%90%E7%9B%AE%E5%BD%95%E4%B8%AA%E6%95%B0%EF%BC%88count_dirs%EF%BC%89">4.4.2.18 è·å–å½“å‰ç›®å½•ä¸‹çš„å­ç›®å½•ä¸ªæ•°ï¼ˆcount_dirsï¼‰</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#45-%E7%AD%BE%E5%90%8D%E6%93%8D%E4%BD%9C%EF%BC%88cossignature%EF%BC%89">4.5 ç­¾åæ“ä½œï¼ˆCOS::Signatureï¼‰</a>

<ul>
<li><a href="#451-%E8%8E%B7%E5%8F%96%E5%8D%95%E6%AC%A1%E6%9C%89%E6%95%88%E7%AD%BE%E5%90%8D%EF%BC%88once%EF%BC%89">4.5.1 è·å–å•æ¬¡æœ‰æ•ˆç­¾åï¼ˆonceï¼‰</a></li>
<li><a href="#452-%E8%8E%B7%E5%8F%96%E5%A4%9A%E6%AC%A1%E6%9C%89%E6%95%88%E7%AD%BE%E5%90%8D%EF%BC%88multiple%EF%BC%89">4.5.2 è·å–å¤šæ¬¡æœ‰æ•ˆç­¾åï¼ˆmultipleï¼‰</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#5-%E5%BA%95%E5%B1%82api%EF%BC%88cosapi%EF%BC%89">5 åº•å±‚APIï¼ˆCOS::APIï¼‰</a>

<ul>
<li><a href="#51-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95create_folder">5.1 åˆ›å»ºç›®å½•(create_folder)</a></li>
<li><a href="#52-%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8%EF%BC%88%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2%EF%BC%89list">5.2 ç›®å½•åˆ—è¡¨ï¼ˆå‰ç¼€æœç´¢ï¼‰(list)</a></li>
<li><a href="#53-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%88%E5%AE%8C%E6%95%B4%E4%B8%8A%E4%BC%A0%EF%BC%89upload">5.3 ä¸Šä¼ æ–‡ä»¶ï¼ˆå®Œæ•´ä¸Šä¼ ï¼‰(upload)</a></li>
<li><a href="#54-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%88%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0%EF%BC%89upload_slice">5.4 ä¸Šä¼ æ–‡ä»¶ï¼ˆåˆ†ç‰‡ä¸Šä¼ ï¼‰(upload_slice)</a></li>
<li><a href="#55-%E6%9B%B4%E6%96%B0%E6%96%87%E4%BB%B6%E3%80%81%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7update">5.5 æ›´æ–°æ–‡ä»¶ã€ç›®å½•å±æ€§(update)</a></li>
<li><a href="#56-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E3%80%81%E7%9B%AE%E5%BD%95delete">5.6 åˆ é™¤æ–‡ä»¶ã€ç›®å½•(delete)</a></li>
<li><a href="#57-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7stat">5.7 è·å–æ–‡ä»¶æˆ–ç›®å½•å±æ€§(stat)</a></li>
<li><a href="#58%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6">5.8ä¸‹è½½æ–‡ä»¶</a></li>
</ul>
</li>
<li><a href="#6-cli%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7">6 CLIå‘½ä»¤è¡Œå·¥å…·</a></li>
<li><a href="#7-%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95">7 è¿è¡Œæµ‹è¯•</a></li>
</ul>
</li>
</ul>

<h2>
<a id="1-è¿è¡Œç¯å¢ƒ" class="anchor" href="#1-%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 è¿è¡Œç¯å¢ƒ</h2>

<ul>
<li>Rubyç‰ˆæœ¬ï¼šMRI &gt;= 1.9.3,  JRuby &gt;= 1.9</li>
<li>æ“ä½œç³»ç»Ÿï¼šWindows/Linux/OS X</li>
</ul>

<h2>
<a id="2-å®‰è£…sdk" class="anchor" href="#2-%E5%AE%89%E8%A3%85sdk" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 å®‰è£…SDK</h2>

<p>æ·»åŠ è‡³åº”ç”¨ç¨‹åºçš„Gemfileæ–‡ä»¶ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">gem</span> <span class="pl-s"><span class="pl-pds">'</span>cos<span class="pl-pds">'</span></span></pre></div>

<p>ç„¶åæ‰§è¡Œï¼š</p>

<pre><code>$ bundle
</code></pre>

<p>æˆ–æ‰‹åŠ¨å®‰è£…gemï¼š</p>

<pre><code>$ gem install cos
</code></pre>

<h2>
<a id="3-å¿«é€Ÿå…¥é—¨" class="anchor" href="#3-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>3 å¿«é€Ÿå…¥é—¨</h2>

<h3>
<a id="31-å‡†å¤‡å·¥ä½œ" class="anchor" href="#31-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.1 å‡†å¤‡å·¥ä½œ</h3>

<p>åœ¨<a href="http://console.qcloud.com/cos">è…¾è®¯äº‘COSæ§åˆ¶å°</a>åˆ›å»ºBucketå¹¶è·å–æ‚¨çš„<code>app_id</code> <code>secret_id</code> <code>secret_key</code> </p>

<p><g-emoji alias="mag" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f50d.png">ğŸ”</g-emoji>å…·ä½“æ“ä½œå¯å‚è€ƒ<a href="http://www.qcloud.com/wiki/COS%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E">COSæ§åˆ¶å°ä½¿ç”¨è¯´æ˜</a></p>

<h3>
<a id="32-åˆå§‹åŒ–" class="anchor" href="#32-%E5%88%9D%E5%A7%8B%E5%8C%96" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.2 åˆå§‹åŒ–</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>cos<span class="pl-pds">'</span></span>

client <span class="pl-k">=</span> <span class="pl-c1">COS</span>::<span class="pl-c1">Client</span>.<span class="pl-k">new</span>({
  <span class="pl-c1">app_id:</span>     <span class="pl-s"><span class="pl-pds">'</span>your_app_id<span class="pl-pds">'</span></span>,
  <span class="pl-c1">secret_id:</span>  <span class="pl-s"><span class="pl-pds">'</span>your_secret_id<span class="pl-pds">'</span></span>,
  <span class="pl-c1">secret_key:</span> <span class="pl-s"><span class="pl-pds">'</span>your_secret_key<span class="pl-pds">'</span></span>,
  <span class="pl-c1">protocol:</span>   <span class="pl-s"><span class="pl-pds">'</span>https<span class="pl-pds">'</span></span> <span class="pl-c"># ä½¿ç”¨https</span>
})</pre></div>

<p>æ›´å¤šåˆå§‹åŒ–å‚æ•°åŠåŠ è½½æ–¹å¼è¯·è§ï¼š <a href="#41-%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E9%85%8D%E7%BD%AE">4.1 åˆå§‹åŒ–ä¸é…ç½®</a></p>

<h3>
<a id="33-æŒ‡å®šbucket" class="anchor" href="#33-%E6%8C%87%E5%AE%9Abucket" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.3 æŒ‡å®šBucket</h3>

<div class="highlight highlight-source-ruby"><pre>bucket <span class="pl-k">=</span> client.bucket(<span class="pl-s"><span class="pl-pds">'</span>your_bucket_name<span class="pl-pds">'</span></span>)</pre></div>

<p><g-emoji alias="tada" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji>ã€Tipã€‘ä½ ä¹Ÿå¯ä»¥åœ¨åˆå§‹åŒ–Clientæ—¶é€šè¿‡<code>default_bucket</code>å‚æ•°è®¾ç½®é»˜è®¤çš„Bucketï¼š</p>

<div class="highlight highlight-source-ruby"><pre>client <span class="pl-k">=</span> <span class="pl-c1">COS</span>::<span class="pl-c1">Client</span>.<span class="pl-k">new</span>({
  <span class="pl-c1">app_id:</span>         <span class="pl-s"><span class="pl-pds">'</span>your_app_id<span class="pl-pds">'</span></span>,
  <span class="pl-c1">secret_id:</span>      <span class="pl-s"><span class="pl-pds">'</span>your_secret_id<span class="pl-pds">'</span></span>,
  <span class="pl-c1">secret_key:</span>     <span class="pl-s"><span class="pl-pds">'</span>your_secret_key<span class="pl-pds">'</span></span>,
  <span class="pl-c1">defualt_bucket:</span> <span class="pl-s"><span class="pl-pds">'</span>your_default_bucket<span class="pl-pds">'</span></span>,
})
<span class="pl-c"># å–å¾—é»˜è®¤Bucket</span>
bucket <span class="pl-k">=</span> client.bucket</pre></div>

<h3>
<a id="34-ç›®å½•æ“ä½œç¤ºä¾‹" class="anchor" href="#34-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.4 ç›®å½•æ“ä½œç¤ºä¾‹</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># åˆ—ä¸¾bucketæ ¹ç›®å½•ä¸­çš„æ–‡ä»¶ä¸ç›®å½•</span>
bucket.list <span class="pl-k">do </span>|<span class="pl-smi">res</span>|
  <span class="pl-k">if</span> res.is_a?(<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span>) <span class="pl-c"># æˆ– res.type == 'dir'</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>Dirï¼š<span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1">res.biz_attr</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"># è®¾ç½®ç›®å½•å±æ€§</span>
    res.update(<span class="pl-s"><span class="pl-pds">'</span>å±æ€§1<span class="pl-pds">'</span></span>)
  <span class="pl-k">else</span>
    <span class="pl-c"># æ–‡ä»¶ COS::COSFile æˆ– res.type == 'file'</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>Fileï¼š<span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"># è¾“å‡ºHashå‚æ•°</span>
    puts res.to_hash
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-c"># å¯ä»¥æŒ‰è·¯å¾„åˆ—å‡ºèµ„æº</span>
bucket.list(<span class="pl-s"><span class="pl-pds">'</span>/path/path2/<span class="pl-pds">'</span></span>) { |<span class="pl-smi">r</span>| puts r.name }

<span class="pl-c"># åªåˆ—å‡ºæ–‡ä»¶</span>
bucket.list(<span class="pl-s"><span class="pl-pds">'</span>/path/path2/<span class="pl-pds">'</span></span>, <span class="pl-c1">:pattern</span> =&gt; <span class="pl-c1">:only_file</span>) { |<span class="pl-smi">r</span>| puts r.name }

<span class="pl-c"># å€’åºåªåˆ—å‡ºç›®å½•</span>
bucket.list(<span class="pl-s"><span class="pl-pds">'</span>/path/path2/<span class="pl-pds">'</span></span>, <span class="pl-c1">:pattern</span> =&gt; <span class="pl-c1">:only_dir</span>, <span class="pl-c1">:order</span> =&gt; <span class="pl-c1">:desc</span>) { |<span class="pl-smi">r</span>| puts r.name }

<span class="pl-c"># è·å–bucketä¿¡æ¯</span>
b <span class="pl-k">=</span> bucket.stat
puts b.refers

<span class="pl-c"># åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨</span>
puts bucket.exist?(<span class="pl-s"><span class="pl-pds">'</span>dir<span class="pl-pds">'</span></span>)
<span class="pl-c"># è·å–ç›®å½•ä¿¡æ¯</span>
dir <span class="pl-k">=</span> bucket.stat(<span class="pl-s"><span class="pl-pds">'</span>dir<span class="pl-pds">'</span></span>)
<span class="pl-c"># åˆ›å»ºæ—¶é—´ä¿®æ”¹æ—¶é—´</span>
puts dir.created_at
puts dir.updated_at
<span class="pl-c"># åˆ¤æ–­ç›®å½•æ˜¯å¦æ˜¯ç©ºçš„</span>
puts dir.empty?
<span class="pl-c"># ç›®å½•ä¸­çš„æ–‡ä»¶åŠç›®å½•æ€»æ•°</span>
puts dir.count
<span class="pl-c"># ç›®å½•ä¸­çš„æ–‡ä»¶æ€»æ•°</span>
puts dir.count_files
<span class="pl-c"># ç›®å½•ä¸­çš„æ–‡ä»¶å¤¹æ€»æ•°</span>
puts dir.count_dirs
<span class="pl-c"># è·å–ç›®å½•çš„æ ‘å½¢ç»“æ„</span>
puts dir.hash_tree.to_json
<span class="pl-c"># åˆ é™¤ç›®å½•</span>
puts dir.delete!
<span class="pl-c"># ä¸Šä¼ æ–‡ä»¶è‡³ç›®å½•, è‡ªåŠ¨å¤§æ–‡ä»¶åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </span>
dir.upload(<span class="pl-s"><span class="pl-pds">'</span>file2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/path2/file2<span class="pl-pds">'</span></span>)
<span class="pl-c"># æ‰¹é‡ä¸Šä¼ æ–‡ä»¶è‡³ç›®å½•ï¼Œè‡ªåŠ¨å¤§æ–‡ä»¶åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </span>
dir.upload_all(<span class="pl-s"><span class="pl-pds">'</span>~/path1<span class="pl-pds">'</span></span>)
<span class="pl-c"># ä¸‹è½½ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè‡ªåŠ¨å¤§æ–‡ä»¶åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </span>
puts bucket.stat(<span class="pl-s"><span class="pl-pds">'</span>path3<span class="pl-pds">'</span></span>).download_all(<span class="pl-s"><span class="pl-pds">'</span>~/path_store<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="35-æ–‡ä»¶æ“ä½œç¤ºä¾‹" class="anchor" href="#35-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>3.5 æ–‡ä»¶æ“ä½œç¤ºä¾‹</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># ä¸Šä¼ æ–‡ä»¶ï¼Œè‡ªåŠ¨å¤§æ–‡ä»¶åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </span>
file <span class="pl-k">=</span> bucket.upload(<span class="pl-s"><span class="pl-pds">'</span>path<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>file1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/local_path/file1<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>
<span class="pl-c"># åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
puts bucket.exist?(<span class="pl-s"><span class="pl-pds">'</span>path/file1<span class="pl-pds">'</span></span>)
<span class="pl-c"># è·å–æ–‡ä»¶ä¿¡æ¯</span>
file <span class="pl-k">=</span> bucket.stat(<span class="pl-s"><span class="pl-pds">'</span>path/file1<span class="pl-pds">'</span></span>)
puts file.name
puts file.biz_attr
<span class="pl-c"># æ›´æ–°æ–‡ä»¶å±æ€§</span>
file.update(<span class="pl-s"><span class="pl-pds">'</span>i am a biz attr<span class="pl-pds">'</span></span>)
<span class="pl-c"># åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆ</span>
puts file.complete?
<span class="pl-c"># è·å–æ–‡ä»¶å¤§å°</span>
puts file.size <span class="pl-c"># file.file_size OR file.filesize</span>
<span class="pl-c"># è·å–æ–‡ä»¶æ ¼å¼åŒ–çš„æ–‡ä»¶å¤§å°</span>
puts file.format_size <span class="pl-c"># 102KB, 3.1MB, 1.5GB</span>
<span class="pl-c"># ä¸‹è½½æ–‡ä»¶ï¼Œè‡ªåŠ¨å¤§æ–‡ä»¶åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </span>
file.download(<span class="pl-s"><span class="pl-pds">'</span>~/path/file1<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸‹è½½è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>
<span class="pl-c"># è·å–æ–‡ä»¶è®¿é—®URLï¼Œç§æœ‰è¯»å–bucketè‡ªåŠ¨æ·»åŠ ç­¾å</span>
file.url(<span class="pl-c1">cname:</span> <span class="pl-s"><span class="pl-pds">'</span>s.domain.com<span class="pl-pds">'</span></span>)
<span class="pl-c"># åˆ é™¤æ–‡ä»¶</span>
file.delete</pre></div>

<h2>
<a id="4-sdkè¯¦ç»†è¯´æ˜" class="anchor" href="#4-sdk%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E" aria-hidden="true"><span class="octicon octicon-link"></span></a>4 SDKè¯¦ç»†è¯´æ˜</h2>

<h3>
<a id="41-åˆå§‹åŒ–ä¸é…ç½®" class="anchor" href="#41-%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E9%85%8D%E7%BD%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.1 åˆå§‹åŒ–ä¸é…ç½®</h3>

<ul>
<li>
<p>4.1.1 è¯¦ç»†å‚æ•°</p>

<div class="highlight highlight-source-ruby"><pre>{
  <span class="pl-c"># COSåˆ†é…çš„app_id</span>
  <span class="pl-c1">:app_id</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>app_id<span class="pl-pds">'</span></span>,
  <span class="pl-c"># COSåˆ†é…çš„secret_id</span>
  <span class="pl-c1">:secret_id</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>secret_id<span class="pl-pds">'</span></span>,
  <span class="pl-c"># COSåˆ†é…çš„secret_key</span>
  <span class="pl-c1">:secret_key</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>secret_key<span class="pl-pds">'</span></span>,
  <span class="pl-c"># COS Reatful API Host</span>
  <span class="pl-c1">:host</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>web.file.myqcloud.com<span class="pl-pds">'</span></span>,
  <span class="pl-c"># ä½¿ç”¨åè®®,é»˜è®¤ä¸ºhttp,å¯é€‰https</span>
  <span class="pl-c1">:protocol</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>https<span class="pl-pds">'</span></span>,
  <span class="pl-c"># æ¥å£é€šè®¯å»ºç«‹è¿æ¥è¶…æ—¶ç§’æ•°</span>
  <span class="pl-c1">:open_timeout</span> =&gt; <span class="pl-c1">15</span>,
  <span class="pl-c"># æ¥å£é€šè®¯è¯»å–æ•°æ®è¶…æ—¶ç§’æ•°</span>
  <span class="pl-c1">:read_timeout</span> =&gt; <span class="pl-c1">120</span>,
  <span class="pl-c"># åŠ è½½é…ç½®æ–‡ä»¶è·¯å¾„</span>
  <span class="pl-c1">:config</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>~/path/cos.yml<span class="pl-pds">'</span></span>,
  <span class="pl-c"># æ—¥å¿—è¾“å‡ºä½ç½®ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶è·¯å¾„ä¹Ÿå¯ä¸ºSTDOUTã€STDERR</span>
  <span class="pl-c1">:log_src</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>/var/log/cos.log<span class="pl-pds">'</span></span>,
  <span class="pl-c"># è¾“å‡ºæ—¥å¿—çº§åˆ«</span>
  <span class="pl-c1">:log_level</span> =&gt; <span class="pl-c1">Logger</span>::<span class="pl-c1">INFO</span>,
  <span class="pl-c"># é»˜è®¤bucket</span>
  <span class="pl-c1">:default_bucket</span> =&gt; <span class="pl-s"><span class="pl-pds">'</span>bucket_name<span class="pl-pds">'</span></span>,
  <span class="pl-c"># å¤šæ¬¡ç­¾åè¿‡æœŸæ—¶é—´(å•ä½ç§’)</span>
  <span class="pl-c1">:multiple_sign_expire</span> =&gt; <span class="pl-c1">300</span>
}</pre></div>
</li>
<li>
<p>4.1.2 æ ‡å‡†æ–¹å¼åˆå§‹åŒ–é…ç½®</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>cos<span class="pl-pds">'</span></span>

<span class="pl-smi">@client</span> <span class="pl-k">=</span> <span class="pl-c1">COS</span>::<span class="pl-c1">Client</span>.<span class="pl-k">new</span>(configs)</pre></div>
</li>
<li>
<p>4.1.3 å®ä¾‹æ–¹å¼åˆå§‹åŒ–é…ç½®</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>cos<span class="pl-pds">'</span></span>

<span class="pl-c"># ç¨‹åºå¯åŠ¨æ—¶åŠ è½½é…ç½®</span>
<span class="pl-c1">COS</span>.client(configs)
<span class="pl-c"># ä½¿ç”¨client</span>
<span class="pl-c1">COS</span>.client.bucket</pre></div>
</li>
<li>
<p>4.1.4 ä»é…ç½®æ–‡ä»¶åŠ è½½é…ç½®</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">require</span> <span class="pl-s"><span class="pl-pds">'</span>cos<span class="pl-pds">'</span></span>

<span class="pl-smi">@client</span> <span class="pl-k">=</span> <span class="pl-c1">COS</span>::<span class="pl-c1">Client</span>.<span class="pl-k">new</span>(<span class="pl-c1">config:</span> <span class="pl-s"><span class="pl-pds">'</span>./cos.yml<span class="pl-pds">'</span></span>)
<span class="pl-c"># æˆ–</span>
<span class="pl-c1">COS</span>.client(<span class="pl-c1">config:</span> <span class="pl-s"><span class="pl-pds">'</span>./cos.yml<span class="pl-pds">'</span></span>)</pre></div>

<p>Railsä¸­ä¼šè‡ªåŠ¨åŠ è½½é¡¹ç›®ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶<code>log/cos.yml</code></p>

<p><g-emoji alias="tada" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png">ğŸ‰</g-emoji>ã€Tipã€‘å¯ä»¥ä½¿ç”¨CLIæŒ‡ä»¤<code>cos init</code>åˆ›å»ºé»˜è®¤çš„ymlé…ç½®æ–‡ä»¶ï¼Œ<code>cos init [é…ç½®æ–‡ä»¶è·¯å¾„]</code>è‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
</li>
</ul>

<h3>
<a id="42-æŒ‡å®šbucket" class="anchor" href="#42-%E6%8C%87%E5%AE%9Abucket" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.2 æŒ‡å®šBucket</h3>

<p>æ‰€æœ‰çš„èµ„æºåŸºæœ¬æ“ä½œæ˜¯åŸºäºä¸€ä¸ªbucketçš„ï¼Œæ‰€æœ‰æˆ‘ä»¬éœ€è¦å…ˆæŒ‡å®šä¸€ä¸ªbucketï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span> <span class="pl-k">=</span> <span class="pl-smi">@client</span>.bucket(<span class="pl-s"><span class="pl-pds">'</span>bucket_name<span class="pl-pds">'</span></span>)
<span class="pl-c"># æˆ–ä½¿ç”¨é…ç½®çš„é»˜è®¤bucket</span>
<span class="pl-smi">@bucket</span> <span class="pl-k">=</span> <span class="pl-smi">@client</span>.bucket</pre></div>

<p>æ³¨ï¼šæŒ‡å®šbucketæ—¶ï¼ŒSDKä¼šè·å–ä¸€æ¬¡bucketä¿¡æ¯ï¼Œè·å–æƒé™ç±»å‹ç­‰ä¿¡æ¯ï¼Œå¦‚bucketä¸å­˜åœ¨å°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>

<h3>
<a id="43-bucketæ“ä½œcosbucket" class="anchor" href="#43-bucket%E6%93%8D%E4%BD%9Ccosbucket" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3 Bucketæ“ä½œï¼ˆCOS::Bucketï¼‰</h3>

<h4>
<a id="431-è·å–bucketå±æ€§" class="anchor" href="#431-%E8%8E%B7%E5%8F%96bucket%E5%B1%9E%E6%80%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.1 è·å–Bucketå±æ€§</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># bucketåç§°</span>
puts <span class="pl-smi">@bucket</span>.bucket_name
<span class="pl-c"># bucketæƒé™</span>
puts <span class="pl-smi">@bucket</span>.authority</pre></div>

<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>bucket_name</td>
<td>String</td>
<td>bucketåç§°</td>
</tr>
<tr>
<td>authority</td>
<td>String</td>
<td>eWPrivateRPublicç§æœ‰å†™å…¬å…±è¯»ï¼ŒeWPrivateç§æœ‰å†™ç§æœ‰è¯»</td>
</tr>
<tr>
<td>bucket_type</td>
<td>Integer</td>
<td>bucket_type</td>
</tr>
<tr>
<td>migrate_source_domain</td>
<td>String</td>
<td>å›æºåœ°å€</td>
</tr>
<tr>
<td>need_preview</td>
<td>String</td>
<td>need_preview</td>
</tr>
<tr>
<td>refers</td>
<td>Array</td>
<td>refers</td>
</tr>
<tr>
<td>blackrefers</td>
<td>Array</td>
<td>blackrefers</td>
</tr>
<tr>
<td>cnames</td>
<td>Array</td>
<td>cnames</td>
</tr>
<tr>
<td>nugc_flag</td>
<td>String</td>
<td>nugc_flag</td>
</tr>
</tbody>
</table>

<h4>
<a id="432-åˆ›å»ºç›®å½•create_foldermkdir" class="anchor" href="#432-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95create_foldermkdir" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.2 åˆ›å»ºç›®å½•ï¼ˆcreate_folderï¼Œmkdirï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.create_folder(path, options <span class="pl-k">=</span> {}) <span class="pl-c"># æ–¹æ³•åˆ«åmkdir</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ç›®å½•å±æ€§, ä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span> <span class="pl-c"># è¯¦è§ç›®å½•æ“ä½œï¼ˆCOS::COSDirï¼‰</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.create_folder(<span class="pl-s"><span class="pl-pds">"</span>test_dir1<span class="pl-pds">"</span></span>, <span class="pl-c1">biz_attr:</span> <span class="pl-s"><span class="pl-pds">'</span>æµ‹è¯•ç›®å½•1<span class="pl-pds">'</span></span>)</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼šexample/create_folder.rb</p>

<h4>
<a id="433-åˆ—ä¸¾ç›®å½•listls" class="anchor" href="#433-%E5%88%97%E4%B8%BE%E7%9B%AE%E5%BD%95listls" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.3 åˆ—ä¸¾ç›®å½•ï¼ˆlistï¼Œlsï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.list(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, options <span class="pl-k">=</span> {}) <span class="pl-c"># æ–¹æ³•åˆ«åls</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>éœ€è¦åˆ—ä¸¾çš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:prefix]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æœç´¢å‰ç¼€ï¼Œå¦‚æœå¡«å†™prefix, åˆ™åˆ—å‡ºå«æ­¤å‰ç¼€çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•</td>
</tr>
<tr>
<td align="left">options[:num]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">20</td>
<td></td>
</tr>
<tr>
<td align="left">options[:pattern]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:both</td>
<td>è·å–æ¨¡å¼ï¼Œ:dir_only åªè·å–ç›®å½•, :file_only åªè·å–æ–‡ä»¶, é»˜è®¤ä¸º :both å…¨éƒ¨è·å–</td>
</tr>
<tr>
<td align="left">options[:order]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:asc</td>
<td>æ’åºæ–¹å¼ :asc æ­£åº, :desc å€’åº é»˜è®¤ä¸º :asc</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>[<span class="pl-c1">Enumerator</span><span class="pl-k">&lt;</span><span class="pl-c1">Object</span><span class="pl-k">&gt;</span>] è¿­ä»£å™¨, å…¶ä¸­<span class="pl-c1">Object</span>å¯èƒ½æ˜¯<span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span>æˆ–<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.list(<span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">res</span>|
  <span class="pl-k">if</span> res.is_a?(<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span>)
    puts <span class="pl-s"><span class="pl-pds">"</span>Dir: <span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1">res.path</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">else</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>File: <span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1">res.format_size</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼šexample/list.rb</p>

<h4>
<a id="434-ä¸Šä¼ æ–‡ä»¶upload" class="anchor" href="#434-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6upload" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.4 ä¸Šä¼ æ–‡ä»¶ï¼ˆuploadï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.upload(path_or_dir, file_name, file_src, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_dir</td>
<td align="center">String/COS::COSDir</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„æˆ–ç›®å½•å¯¹è±¡COSDirç›®å½•è·¯å¾„å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">file_name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>å­˜å‚¨æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">file_src</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:auto_create_folder]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>è‡ªåŠ¨åˆ›å»ºè¿œç«¯ç›®å½•</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10 * 1024 * 1024</td>
<td>å®Œæ•´ä¸Šä¼ æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:upload_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸Šä¼ é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚ç¦ç”¨ä»å¯é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œæ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:threads]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>å¤šçº¿ç¨‹ä¸Šä¼ çº¿ç¨‹æ•°</td>
</tr>
<tr>
<td align="left">options[:slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">3 * 1024 * 1024</td>
<td>è®¾ç½®åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ã€‚é»˜è®¤ä¸º3 MB, ç›®å‰æœåŠ¡ç«¯æœ€å¤§é™åˆ¶ä¹Ÿä¸º3MBã€‚</td>
</tr>
<tr>
<td align="left">options[:cpt_file]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–­ç‚¹ç»­ä¼ çš„checkpointæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸Šä¼ è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šSDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸Šä¼ å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span> <span class="pl-c"># è¯¦è§ç›®å½•æ“ä½œï¼ˆCOS::COSFileï¼‰</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file <span class="pl-k">=</span> <span class="pl-smi">@bucket</span>.upload(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>file1.txt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test.txt<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>
puts file.name
puts file.format_size
puts file.url</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼š example/upload.rb</p>

<h4>
<a id="434-èµ„æºå±æ€§stat" class="anchor" href="#434-%E8%B5%84%E6%BA%90%E5%B1%9E%E6%80%A7stat" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.4 èµ„æºå±æ€§ï¼ˆstatï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.stat(path)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºè·¯å¾„, å¦‚: ç›®å½•'path1/', æ–‡ä»¶'path1/file'ã€‚</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>å¯èƒ½æ˜¯<span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span>(æ–‡ä»¶)æˆ–<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span>(ç›®å½•)</pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.stat(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>).name</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼š example/stat.rb</p>

<h4>
<a id="435-æ›´æ–°èµ„æºå±æ€§upadte" class="anchor" href="#435-%E6%9B%B4%E6%96%B0%E8%B5%84%E6%BA%90%E5%B1%9E%E6%80%A7upadte" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.5 æ›´æ–°èµ„æºå±æ€§ï¼ˆupadteï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.update(path, biz_attr)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºè·¯å¾„, å¦‚: ç›®å½•'path1/', æ–‡ä»¶'path1/file'ã€‚</td>
</tr>
<tr>
<td align="left">biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.update(<span class="pl-s"><span class="pl-pds">'</span>test/file1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>new biz attr<span class="pl-pds">'</span></span>)</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼š example/update.rb</p>

<h4>
<a id="436-åˆ é™¤èµ„æºdelete" class="anchor" href="#436-%E5%88%A0%E9%99%A4%E8%B5%84%E6%BA%90delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.6 åˆ é™¤èµ„æºï¼ˆdeleteï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.delete(path)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºè·¯å¾„, å¦‚: ç›®å½•'path1/', æ–‡ä»¶'path1/file'ã€‚</td>
</tr>
</tbody>
</table>

<p>æ³¨æ„ï¼šéç©ºç›®å½•æˆ–æ ¹ç›®å½•æ— æ³•åˆ é™¤ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</p>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.delete(<span class="pl-s"><span class="pl-pds">'</span>test/<span class="pl-pds">'</span></span>)</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼šexample/delete.rb</p>

<h4>
<a id="437-åˆ é™¤èµ„æºæ— å¼‚å¸¸delete" class="anchor" href="#437-%E5%88%A0%E9%99%A4%E8%B5%84%E6%BA%90%E6%97%A0%E5%BC%82%E5%B8%B8delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.7 åˆ é™¤èµ„æºï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.delete!(path)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºè·¯å¾„, å¦‚: ç›®å½•'path1/', æ–‡ä»¶'path1/file'ã€‚</td>
</tr>
</tbody>
</table>

<p>æ³¨æ„ï¼šéç©ºç›®å½•æˆ–æ ¹ç›®å½•æ— æ³•åˆ é™¤ï¼Œè¿”å›æ˜¯å¦æˆåŠŸçš„boolå€¼ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.delete!(<span class="pl-s"><span class="pl-pds">'</span>test/<span class="pl-pds">'</span></span>)</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼šexample/delete.rb</p>

<h4>
<a id="438-åˆ¤æ–­ç›®å½•æ˜¯å¦ä¸ºç©ºempty" class="anchor" href="#438-%E5%88%A4%E6%96%AD%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BAempty" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.8 åˆ¤æ–­ç›®å½•æ˜¯å¦ä¸ºç©ºï¼ˆempty?ï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.empty?(path)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„, å¦‚: ç›®å½•'path1/'ã€‚å¦‚ä¸ºç©ºåˆ™ä¼šåˆ¤æ–­bucketæ˜¯å¦ä¸ºç©ºã€‚</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># ç›®å½•æ˜¯å¦ä¸ºç©º</span>
puts <span class="pl-smi">@bucket</span>.empty?(<span class="pl-s"><span class="pl-pds">'</span>test/<span class="pl-pds">'</span></span>)
<span class="pl-c"># bucketæ˜¯å¦ä¸ºç©º</span>
puts <span class="pl-smi">@bucket</span>.empty?</pre></div>

<h4>
<a id="439-åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨existexists" class="anchor" href="#439-%E5%88%A4%E6%96%AD%E8%B5%84%E6%BA%90%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8existexists" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.9 åˆ¤æ–­èµ„æºæ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.exist?(path) <span class="pl-c"># åˆ«å exists?</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºè·¯å¾„, å¦‚: ç›®å½•'path1/', æ–‡ä»¶'path1/file'</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.exist?(<span class="pl-s"><span class="pl-pds">'</span>test/<span class="pl-pds">'</span></span>)
puts <span class="pl-smi">@bucket</span>.exist?(<span class="pl-s"><span class="pl-pds">'</span>test/file1<span class="pl-pds">'</span></span>)</pre></div>

<h4>
<a id="439-åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆcomplete" class="anchor" href="#439-%E5%88%A4%E6%96%AD%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%8A%E4%BC%A0%E5%AE%8C%E6%88%90complete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.9 åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆï¼ˆcomplete?ï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.complete?(path)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æ–‡ä»¶èµ„æºè·¯å¾„, å¦‚: 'path1/file'</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.complete?(<span class="pl-s"><span class="pl-pds">'</span>path/file1<span class="pl-pds">'</span></span>)</pre></div>

<h4>
<a id="4310-è·å–æ–‡ä»¶çš„è®¿é—®urlurl" class="anchor" href="#4310-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AEurlurl" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.10 è·å–æ–‡ä»¶çš„è®¿é—®URLï¼ˆurlï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.url(path_or_file, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_file</td>
<td align="center">String/COS::COSFile</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>æ–‡ä»¶èµ„æºCOSFileæˆ–è·¯å¾„, å¦‚: 'path1/file'</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:cname]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>è·å–ä½¿ç”¨cnameçš„urlã€‚åœ¨cosæ§åˆ¶å°è®¾ç½®çš„cnameåŸŸå</td>
</tr>
<tr>
<td align="left">options[:https]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦è·å–httpsçš„url</td>
</tr>
<tr>
<td align="left">options[:expire_seconds]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">600</td>
<td>ç­¾åæœ‰æ•ˆæ—¶é—´(ç§’,ç§æœ‰è¯»å–bucketæ—¶éœ€è¦)</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">String</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts bucket.url(<span class="pl-s"><span class="pl-pds">'</span>path1/file1<span class="pl-pds">'</span></span>, <span class="pl-c1">https:</span> <span class="pl-c1">true</span>, <span class="pl-c1">cname:</span> <span class="pl-s"><span class="pl-pds">'</span>static.domain.com<span class="pl-pds">'</span></span>)</pre></div>

<h4>
<a id="4311-ä¸‹è½½æ–‡ä»¶download" class="anchor" href="#4311-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6download" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.11 ä¸‹è½½æ–‡ä»¶ï¼ˆdownloadï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.download(path_or_file, file_store, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_file</td>
<td align="center">String/COS::COSFile</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æ–‡ä»¶èµ„æºCOSFileæˆ–è·¯å¾„, å¦‚: 'path1/file'</td>
</tr>
<tr>
<td align="left">file_store</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:disable_mkdir]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">true</td>
<td>ç¦æ­¢è‡ªåŠ¨åˆ›å»ºæœ¬åœ°æ–‡ä»¶å¤¹, é»˜è®¤ä¼šåˆ›å»º</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5 * 10 * 1024</td>
<td>å®Œæ•´ä¸‹è½½æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:download_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸‹è½½é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚æœç¦ç”¨åˆ™ä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸‹è½½è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šæ”¯æŒç§æœ‰è®¿é—®èµ„æºä¸‹è½½ï¼ŒSDKä¼šè‡ªåŠ¨æºå¸¦é‰´æƒç­¾åã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸‹è½½å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">String</span> <span class="pl-c"># æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file <span class="pl-k">=</span> bucket.download(<span class="pl-s"><span class="pl-pds">'</span>path/file1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test/file1<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">p</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸‹è½½è¿›åº¦: <span class="pl-pse">#{</span><span class="pl-s1">(p<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>
puts file</pre></div>

<p>æ›´å¤šç¤ºä¾‹è¯¦è§ï¼šexample/download.rb</p>

<h4>
<a id="4312-è·å–objectæ ‘å½¢ç»“æ„tree" class="anchor" href="#4312-%E8%8E%B7%E5%8F%96object%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.12 è·å–Objectæ ‘å½¢ç»“æ„ï¼ˆtreeï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.tree(path_or_dir <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_dir</td>
<td align="center">String/COS::COSDir</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„æˆ–ç›®å½•å¯¹è±¡COSDirç›®å½•è·¯å¾„å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:depth]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5</td>
<td>å­ç›®å½•æ·±åº¦,é»˜è®¤ä¸º5</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<pre><code>{
    :resource =&gt; Object&lt;COS::COSDir&gt;,
    :children =&gt; [
        {:resource =&gt; Object&lt;COS::COSDir&gt;, :children =&gt; [...]},
        {:resource =&gt; Object&lt;COS::COSFile&gt;, :children =&gt; [...]},
        ...
    ]
}
</code></pre>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>tree <span class="pl-k">=</span> <span class="pl-smi">@bucket</span>.tree
puts tree[<span class="pl-c1">:resource</span>].name
tree[<span class="pl-c1">:children</span>].each <span class="pl-k">do </span>|<span class="pl-smi">r</span>|
  puts r[<span class="pl-c1">:resource</span>].name
<span class="pl-k">end</span></pre></div>

<h4>
<a id="4313-è·å–hashæ ‘å½¢ç»“æ„hash_tree" class="anchor" href="#4313-%E8%8E%B7%E5%8F%96hash%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84hash_tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.13 è·å–Hashæ ‘å½¢ç»“æ„ï¼ˆhash_treeï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.hash_tree(path_or_dir <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_dir</td>
<td align="center">String/COS::COSDir</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„æˆ–ç›®å½•å¯¹è±¡COSDirç›®å½•è·¯å¾„å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:depth]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5</td>
<td>å­ç›®å½•æ·±åº¦,é»˜è®¤ä¸º5</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<pre><code>{
    :resource =&gt; {:name...},
    :children =&gt; [
        {:resource =&gt; {:name...}, :children =&gt; [...]},
        {:resource =&gt; {:name...}, :children =&gt; [...]},
        ...
    ]
}
</code></pre>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>tree <span class="pl-k">=</span> <span class="pl-smi">@bucket</span>.hash_tree
puts tree[<span class="pl-c1">:resource</span>][<span class="pl-c1">:name</span>]
tree[<span class="pl-c1">:children</span>].each <span class="pl-k">do </span>|<span class="pl-smi">r</span>|
  puts r[<span class="pl-c1">:resource</span>][<span class="pl-c1">:name</span>]
<span class="pl-k">end</span>
puts tree.to_json <span class="pl-c"># å¯ç›´æ¥è½¬ä¸ºjson</span></pre></div>

<h4>
<a id="4314-æ‰¹é‡ä¸‹è½½ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶download_all" class="anchor" href="#4314-%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6download_all" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.14 æ‰¹é‡ä¸‹è½½ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆdownload_allï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.download_all(path_or_dir, file_store_path, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_dir</td>
<td align="center">String/COS::COSDir</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„æˆ–ç›®å½•å¯¹è±¡COSDirç›®å½•è·¯å¾„å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">file_store_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å­˜å‚¨ç›®å½•</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:disable_mkdir]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">true</td>
<td>ç¦æ­¢è‡ªåŠ¨åˆ›å»ºæœ¬åœ°æ–‡ä»¶å¤¹, é»˜è®¤ä¼šåˆ›å»º</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5 * 10 * 1024</td>
<td>å®Œæ•´ä¸‹è½½æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:download_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸‹è½½é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚æœç¦ç”¨åˆ™ä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸‹è½½è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šä¸åŒ…å«å­ç›®å½•ã€‚æ”¯æŒç§æœ‰è®¿é—®èµ„æºä¸‹è½½ï¼ŒSDKä¼šè‡ªåŠ¨æºå¸¦é‰´æƒç­¾åã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸‹è½½å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Array</span><span class="pl-k">&lt;</span><span class="pl-c1">String</span><span class="pl-k">&gt;</span> <span class="pl-c"># æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„æ•°ç»„</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>files <span class="pl-k">=</span> bucket.download_all(<span class="pl-s"><span class="pl-pds">'</span>path/<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test/path/<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">p</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸‹è½½è¿›åº¦: <span class="pl-pse">#{</span><span class="pl-s1">(p<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>
puts files</pre></div>

<h4>
<a id="4315-æ‰¹é‡ä¸Šä¼ ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶upload_all" class="anchor" href="#4315-%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6upload_all" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.15 æ‰¹é‡ä¸Šä¼ ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆupload_allï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.upload(path_or_dir, file_src_path, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path_or_dir</td>
<td align="center">String/COS::COSDir</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„æˆ–ç›®å½•å¯¹è±¡COSDirç›®å½•è·¯å¾„å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">file_src_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å¤¹è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:skip_error]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦è·³è¿‡é”™è¯¯ä»ç»§ç»­ä¸Šä¼ ä¸‹ä¸€ä¸ªæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">options[:auto_create_folder]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>è‡ªåŠ¨åˆ›å»ºè¿œç«¯ç›®å½•</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10 * 1024 * 1024</td>
<td>å®Œæ•´ä¸Šä¼ æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:upload_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸Šä¼ é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚ç¦ç”¨ä»å¯é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œæ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:threads]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>å¤šçº¿ç¨‹ä¸Šä¼ çº¿ç¨‹æ•°</td>
</tr>
<tr>
<td align="left">options[:slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">3 * 1024 * 1024</td>
<td>è®¾ç½®åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ã€‚é»˜è®¤ä¸º3 MB, ç›®å‰æœåŠ¡ç«¯æœ€å¤§é™åˆ¶ä¹Ÿä¸º3MBã€‚</td>
</tr>
<tr>
<td align="left">options[:cpt_file]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–­ç‚¹ç»­ä¼ çš„checkpointæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸Šä¼ è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šä¸åŒ…å«å­ç›®å½•ã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸Šä¼ å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Array</span><span class="pl-k">&lt;</span><span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span><span class="pl-k">&gt;</span> <span class="pl-c"># è¯¦è§ç›®å½•æ“ä½œï¼ˆCOS::COSFileï¼‰</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>files <span class="pl-k">=</span> <span class="pl-smi">@bucket</span>.upload_all(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/path<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>
puts files</pre></div>

<h4>
<a id="4316-è·å–èµ„æºä¸ªæ•°è¯¦æƒ…æ”¯æŒå‰ç¼€æœç´¢list_count" class="anchor" href="#4316-%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%E8%AF%A6%E6%83%85%E6%94%AF%E6%8C%81%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2list_count" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.16 è·å–èµ„æºä¸ªæ•°è¯¦æƒ…ï¼ˆæ”¯æŒå‰ç¼€æœç´¢ï¼‰ï¼ˆlist_countï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.list_count(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚é»˜è®¤è·å–bucketæ ¹ç›®å½•</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:prefix]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>å‰ç¼€æœç´¢</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Hash</span>
{
  <span class="pl-c1">:total</span> =&gt; <span class="pl-c1">5</span>, <span class="pl-c"># ç›®å½•åŠæ–‡ä»¶æ€»æ•°</span>
  <span class="pl-c1">:files</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c"># æ–‡ä»¶æ€»æ•°</span>
  <span class="pl-c1">:dirs</span> =&gt; <span class="pl-c1">3</span>, <span class="pl-c"># ç›®å½•æ€»æ•°</span>
}</pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.list_count[<span class="pl-c1">:files</span>]</pre></div>

<h4>
<a id="4317-è·å–èµ„æºä¸ªæ•°count-size" class="anchor" href="#4317-%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0count-size" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.17 è·å–èµ„æºä¸ªæ•°ï¼ˆcount, sizeï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.count(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>) <span class="pl-c"># åˆ«å size</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚é»˜è®¤è·å–bucketæ ¹ç›®å½•</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># ç›®å½•åŠæ–‡ä»¶æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.count</pre></div>

<h4>
<a id="4318-è·å–æ–‡ä»¶ä¸ªæ•°count_files" class="anchor" href="#4318-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E4%B8%AA%E6%95%B0count_files" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.18 è·å–æ–‡ä»¶ä¸ªæ•°ï¼ˆcount_filesï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.count_files(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚é»˜è®¤è·å–bucketæ ¹ç›®å½•</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># æ–‡ä»¶æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.count_files</pre></div>

<h4>
<a id="4319-è·å–ç›®å½•ä¸ªæ•°count_dirs" class="anchor" href="#4319-%E8%8E%B7%E5%8F%96%E7%9B%AE%E5%BD%95%E4%B8%AA%E6%95%B0count_dirs" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.3.19 è·å–ç›®å½•ä¸ªæ•°ï¼ˆcount_dirsï¼‰</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@bucket</span>.count_dirs(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚é»˜è®¤è·å–bucketæ ¹ç›®å½•</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># ç›®å½•æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@bucket</span>.count_dirs</pre></div>

<h3>
<a id="44-èµ„æºæ“ä½œ" class="anchor" href="#44-%E8%B5%84%E6%BA%90%E6%93%8D%E4%BD%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4 èµ„æºæ“ä½œ</h3>

<h4>
<a id="441-æ–‡ä»¶æ“ä½œcoscosfile" class="anchor" href="#441-%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9Ccoscosfile" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1 æ–‡ä»¶æ“ä½œï¼ˆCOS::COSFileï¼‰</h4>

<h5>
<a id="4411-è·å–æ–‡ä»¶å±æ€§" class="anchor" href="#4411-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.1 è·å–æ–‡ä»¶å±æ€§</h5>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># æ–‡ä»¶åç§° </span>
puts file.name
<span class="pl-c"># æ–‡ä»¶æ ¼å¼åŒ–å¤§å° 1B 1KB 1.1MB 1.12GB...</span>
puts file.format_size</pre></div>

<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>åç§°</td>
</tr>
<tr>
<td>path</td>
<td>String</td>
<td>å­˜å‚¨è·¯å¾„</td>
</tr>
<tr>
<td>ctime</td>
<td>String</td>
<td>åˆ›å»ºæ—¶é—´unixæ—¶é—´æˆ³</td>
</tr>
<tr>
<td>mtime</td>
<td>String</td>
<td>ä¿®æ”¹æ—¶é—´unixæ—¶é—´æˆ³</td>
</tr>
<tr>
<td>created_at</td>
<td>Time</td>
<td>åˆ›å»ºæ—¶é—´Time</td>
</tr>
<tr>
<td>updated_at</td>
<td>Time</td>
<td>ä¿®æ”¹æ—¶é—´Time</td>
</tr>
<tr>
<td>biz_attr</td>
<td>String</td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td>filesizeï¼ˆfile_size, sizeï¼‰</td>
<td>Integer</td>
<td>æ–‡ä»¶å¤§å°</td>
</tr>
<tr>
<td>filelen</td>
<td>Integer</td>
<td>å·²ä¸Šä¼ çš„æ–‡ä»¶å¤§å°</td>
</tr>
<tr>
<td>sha</td>
<td>String</td>
<td>æ–‡ä»¶sha1å€¼</td>
</tr>
<tr>
<td>access_url</td>
<td>String</td>
<td>æ–‡ä»¶è®¿é—®url</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>ç±»å‹ï¼Œå›ºå®šä¸ºfile</td>
</tr>
<tr>
<td>format_size</td>
<td>String</td>
<td>æ ¼å¼åŒ–æ–‡ä»¶å¤§å° 1B 1KB 1.1MB 1.12GB</td>
</tr>
</tbody>
</table>

<h5>
<a id="4412-è·å–å½“å‰æ–‡ä»¶å±æ€§åˆ·æ–°stat" class="anchor" href="#4412-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E5%88%B7%E6%96%B0stat" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.2 è·å–å½“å‰æ–‡ä»¶å±æ€§ï¼ˆåˆ·æ–°ï¼‰ï¼ˆstatï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.stat</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.stat.to_hash</pre></div>

<h5>
<a id="4413-æ›´æ–°å½“å‰æ–‡ä»¶å±æ€§upadte" class="anchor" href="#4413-%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7upadte" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.3 æ›´æ–°å½“å‰æ–‡ä»¶å±æ€§ï¼ˆupadteï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.update(biz_attr)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file.update(<span class="pl-s"><span class="pl-pds">'</span>new biz attr<span class="pl-pds">'</span></span>)</pre></div>

<h5>
<a id="4414-åˆ é™¤å½“å‰æ–‡ä»¶delete" class="anchor" href="#4414-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.4 åˆ é™¤å½“å‰æ–‡ä»¶ï¼ˆdeleteï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.delete</pre></div>

<p>æ³¨æ„ï¼šåˆ é™¤å¤±è´¥å°†æŠ›å‡ºå¼‚å¸¸</p>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file.delete</pre></div>

<h5>
<a id="4415-åˆ é™¤å½“å‰æ–‡ä»¶æ— å¼‚å¸¸delete" class="anchor" href="#4415-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E6%97%A0%E5%BC%82%E5%B8%B8delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.5 åˆ é™¤å½“å‰æ–‡ä»¶ï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.delete!</pre></div>

<p>æ³¨æ„ï¼šåˆ é™¤å¤±è´¥ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¿”å›æ˜¯å¦æˆåŠŸçš„boolå€¼ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.delete!</pre></div>

<h5>
<a id="4416-åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦å­˜åœ¨existexists" class="anchor" href="#4416-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8existexists" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.6 åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.exist? <span class="pl-c"># åˆ«å exists?</span></pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.exist?</pre></div>

<h5>
<a id="4417-åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆcomplete" class="anchor" href="#4417-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%8A%E4%BC%A0%E5%AE%8C%E6%88%90complete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.7 åˆ¤æ–­å½“å‰æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæˆï¼ˆcomplete?ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.complete?</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.complete?</pre></div>

<h5>
<a id="4418-è·å–å½“å‰æ–‡ä»¶çš„è®¿é—®urlurl" class="anchor" href="#4418-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E7%9A%84%E8%AE%BF%E9%97%AEurlurl" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.8 è·å–å½“å‰æ–‡ä»¶çš„è®¿é—®URLï¼ˆurlï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.url(options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:cname]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>è·å–ä½¿ç”¨cnameçš„urlã€‚åœ¨cosæ§åˆ¶å°è®¾ç½®çš„cnameåŸŸå</td>
</tr>
<tr>
<td align="left">options[:https]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦è·å–httpsçš„url</td>
</tr>
<tr>
<td align="left">options[:expire_seconds]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">600</td>
<td>ç­¾åæœ‰æ•ˆæ—¶é—´(ç§’,ç§æœ‰è¯»å–bucketæ—¶éœ€è¦)</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">String</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.url(<span class="pl-c1">https:</span> <span class="pl-c1">true</span>, <span class="pl-c1">cname:</span> <span class="pl-s"><span class="pl-pds">'</span>static.domain.com<span class="pl-pds">'</span></span>)</pre></div>

<h5>
<a id="4419-ä¸‹è½½å½“å‰æ–‡ä»¶download" class="anchor" href="#4419-%E4%B8%8B%E8%BD%BD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6download" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.9 ä¸‹è½½å½“å‰æ–‡ä»¶ï¼ˆdownloadï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>file.download(file_store, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">file_store</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:disable_mkdir]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">true</td>
<td>ç¦æ­¢è‡ªåŠ¨åˆ›å»ºæœ¬åœ°æ–‡ä»¶å¤¹, é»˜è®¤ä¼šåˆ›å»º</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5 * 10 * 1024</td>
<td>å®Œæ•´ä¸‹è½½æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:download_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸‹è½½é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚æœç¦ç”¨åˆ™ä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸‹è½½è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šæ”¯æŒç§æœ‰è®¿é—®èµ„æºä¸‹è½½ï¼ŒSDKä¼šè‡ªåŠ¨æºå¸¦é‰´æƒç­¾åã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸‹è½½å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">String</span> <span class="pl-c"># æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file <span class="pl-k">=</span> file.download(<span class="pl-s"><span class="pl-pds">'</span>~/test/file1<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">p</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸‹è½½è¿›åº¦: <span class="pl-pse">#{</span><span class="pl-s1">(p<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span>
puts file</pre></div>

<h5>
<a id="44110-åˆ¤æ–­å½“å‰æ–‡ä»¶ä¸æœ¬åœ°æ–‡ä»¶æ˜¯å¦ç›¸åŒ" class="anchor" href="#44110-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E6%96%87%E4%BB%B6%E4%B8%8E%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E7%9B%B8%E5%90%8C" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.1.10 åˆ¤æ–­å½“å‰æ–‡ä»¶ä¸æœ¬åœ°æ–‡ä»¶æ˜¯å¦ç›¸åŒ</h5>

<div class="highlight highlight-source-ruby"><pre>file.sha1_match?(file)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">file</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶è·¯å¾„</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts file.sha1_match?(<span class="pl-s"><span class="pl-pds">'</span>~/file1<span class="pl-pds">'</span></span>)</pre></div>

<h4>
<a id="442-ç›®å½•æ“ä½œcoscosdir" class="anchor" href="#442-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9Ccoscosdir" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2 ç›®å½•æ“ä½œï¼ˆCOS::COSDirï¼‰</h4>

<h5>
<a id="4421-è·å–ç›®å½•å±æ€§" class="anchor" href="#4421-%E8%8E%B7%E5%8F%96%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.1 è·å–ç›®å½•å±æ€§</h5>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># ç›®å½•åç§° </span>
puts dir.name
<span class="pl-c"># ç›®å½•å­˜å‚¨è·¯å¾„</span>
puts dir.path</pre></div>

<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>åç§°</td>
</tr>
<tr>
<td>path</td>
<td>String</td>
<td>å­˜å‚¨è·¯å¾„</td>
</tr>
<tr>
<td>ctime</td>
<td>String</td>
<td>åˆ›å»ºæ—¶é—´unixæ—¶é—´æˆ³</td>
</tr>
<tr>
<td>mtime</td>
<td>String</td>
<td>ä¿®æ”¹æ—¶é—´unixæ—¶é—´æˆ³</td>
</tr>
<tr>
<td>created_at</td>
<td>Time</td>
<td>åˆ›å»ºæ—¶é—´Time</td>
</tr>
<tr>
<td>updated_at</td>
<td>Time</td>
<td>ä¿®æ”¹æ—¶é—´Time</td>
</tr>
<tr>
<td>biz_attr</td>
<td>String</td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>ç±»å‹ï¼Œå›ºå®šä¸ºdir</td>
</tr>
</tbody>
</table>

<h5>
<a id="4422-åˆ—ä¸¾å½“å‰ç›®å½•å‰ç¼€æœç´¢listls" class="anchor" href="#4422-%E5%88%97%E4%B8%BE%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2listls" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.2 åˆ—ä¸¾å½“å‰ç›®å½•ï¼ˆå‰ç¼€æœç´¢ï¼‰ï¼ˆlistï¼Œlsï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.list(options <span class="pl-k">=</span> {}) <span class="pl-c"># æ–¹æ³•åˆ«åls</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:prefix]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æœç´¢å‰ç¼€ï¼Œå¦‚æœå¡«å†™prefix, åˆ™åˆ—å‡ºå«æ­¤å‰ç¼€çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•</td>
</tr>
<tr>
<td align="left">options[:num]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">20</td>
<td></td>
</tr>
<tr>
<td align="left">options[:pattern]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:both</td>
<td>è·å–æ¨¡å¼ï¼Œ:dir_only åªè·å–ç›®å½•, :file_only åªè·å–æ–‡ä»¶, é»˜è®¤ä¸º :both å…¨éƒ¨è·å–</td>
</tr>
<tr>
<td align="left">options[:order]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:asc</td>
<td>æ’åºæ–¹å¼ :asc æ­£åº, :desc å€’åº é»˜è®¤ä¸º :asc</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>[<span class="pl-c1">Enumerator</span><span class="pl-k">&lt;</span><span class="pl-c1">Object</span><span class="pl-k">&gt;</span>] è¿­ä»£å™¨, å…¶ä¸­<span class="pl-c1">Object</span>å¯èƒ½æ˜¯<span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span>æˆ–<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>dir.list <span class="pl-k">do </span>|<span class="pl-smi">res</span>|
  <span class="pl-k">if</span> res.is_a?(<span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span>)
    puts <span class="pl-s"><span class="pl-pds">"</span>Dir: <span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1">res.path</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">else</span>
    puts <span class="pl-s"><span class="pl-pds">"</span>File: <span class="pl-pse">#{</span><span class="pl-s1">res.name</span><span class="pl-pse"><span class="pl-s1">}</span></span> <span class="pl-pse">#{</span><span class="pl-s1">res.format_size</span><span class="pl-pse"><span class="pl-s1">}</span></span><span class="pl-pds">"</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h5>
<a id="4423-åˆ›å»ºå­ç›®å½•create_foldermkdir" class="anchor" href="#4423-%E5%88%9B%E5%BB%BA%E5%AD%90%E7%9B%AE%E5%BD%95create_foldermkdir" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.3 åˆ›å»ºå­ç›®å½•ï¼ˆcreate_folderï¼Œmkdirï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.create_folder(dir_name, options <span class="pl-k">=</span> {}) <span class="pl-c"># æ–¹æ³•åˆ«åmkdir</span></pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">dir_name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„å­ç›®å½•åç§°ï¼Œä¸åŒ…å«çˆ¶ç³»ç›®å½•è·¯å¾„ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ç›®å½•å±æ€§, ä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>dir.create_folder(<span class="pl-s"><span class="pl-pds">"</span>test_dir2<span class="pl-pds">"</span></span>, <span class="pl-c1">biz_attr:</span> <span class="pl-s"><span class="pl-pds">'</span>æµ‹è¯•ç›®å½•1-2<span class="pl-pds">'</span></span>)</pre></div>

<h5>
<a id="4424-ä¸Šä¼ æ–‡ä»¶è‡³å½“å‰ç›®å½•upload" class="anchor" href="#4424-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E8%87%B3%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95upload" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.4 ä¸Šä¼ æ–‡ä»¶è‡³å½“å‰ç›®å½•ï¼ˆuploadï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.upload(file_name, file_src, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">file_name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>å­˜å‚¨æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">file_src</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:auto_create_folder]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>è‡ªåŠ¨åˆ›å»ºè¿œç«¯ç›®å½•</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10 * 1024 * 1024</td>
<td>å®Œæ•´ä¸Šä¼ æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:upload_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸Šä¼ é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚ç¦ç”¨ä»å¯é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œæ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:threads]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>å¤šçº¿ç¨‹ä¸Šä¼ çº¿ç¨‹æ•°</td>
</tr>
<tr>
<td align="left">options[:slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">3 * 1024 * 1024</td>
<td>è®¾ç½®åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ã€‚é»˜è®¤ä¸º3 MB, ç›®å‰æœåŠ¡ç«¯æœ€å¤§é™åˆ¶ä¹Ÿä¸º3MBã€‚</td>
</tr>
<tr>
<td align="left">options[:cpt_file]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–­ç‚¹ç»­ä¼ çš„checkpointæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸Šä¼ è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šSDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸Šä¼ å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>file <span class="pl-k">=</span> dir.upload(<span class="pl-s"><span class="pl-pds">'</span>file1.txt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test.txt<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span>
puts file.name
puts file.format_size
puts file.url</pre></div>

<h5>
<a id="4425-æ‰¹é‡ä¸Šä¼ æœ¬åœ°ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶è‡³å½“å‰ç›®å½•upload_all" class="anchor" href="#4425-%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E6%9C%AC%E5%9C%B0%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E8%87%B3%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95upload_all" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.5 æ‰¹é‡ä¸Šä¼ æœ¬åœ°ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶è‡³å½“å‰ç›®å½•ï¼ˆupload_allï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.upload(file_src_path, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">file_src_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å¤¹è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:skip_error]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦è·³è¿‡é”™è¯¯ä»ç»§ç»­ä¸Šä¼ ä¸‹ä¸€ä¸ªæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">options[:auto_create_folder]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>è‡ªåŠ¨åˆ›å»ºè¿œç«¯ç›®å½•</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10 * 1024 * 1024</td>
<td>å®Œæ•´ä¸Šä¼ æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:upload_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸Šä¼ é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚ç¦ç”¨ä»å¯é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œæ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:threads]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>å¤šçº¿ç¨‹ä¸Šä¼ çº¿ç¨‹æ•°</td>
</tr>
<tr>
<td align="left">options[:slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">3 * 1024 * 1024</td>
<td>è®¾ç½®åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ã€‚é»˜è®¤ä¸º3 MB, ç›®å‰æœåŠ¡ç«¯æœ€å¤§é™åˆ¶ä¹Ÿä¸º3MBã€‚</td>
</tr>
<tr>
<td align="left">options[:cpt_file]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–­ç‚¹ç»­ä¼ çš„checkpointæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸Šä¼ è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šä¸åŒ…å«å­ç›®å½•ã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸Šä¼ å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Array</span><span class="pl-k">&lt;</span><span class="pl-c1">COS</span>::<span class="pl-c1">COSFile</span><span class="pl-k">&gt;</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>files <span class="pl-k">=</span> dir.upload_all(<span class="pl-s"><span class="pl-pds">'</span>~/path<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span></pre></div>

<h5>
<a id="4426-æ‰¹é‡ä¸‹è½½å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶download_all" class="anchor" href="#4426-%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6download_all" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.6 æ‰¹é‡ä¸‹è½½å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆdownload_allï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.download_all(file_store_path, options <span class="pl-k">=</span> {}, <span class="pl-k">&amp;</span>block)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">file_store_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å­˜å‚¨ç›®å½•</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:disable_mkdir]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">true</td>
<td>ç¦æ­¢è‡ªåŠ¨åˆ›å»ºæœ¬åœ°æ–‡ä»¶å¤¹, é»˜è®¤ä¼šåˆ›å»º</td>
</tr>
<tr>
<td align="left">options[:min_slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5 * 10 * 1024</td>
<td>å®Œæ•´ä¸‹è½½æœ€å°æ–‡ä»¶å¤§å°,è¶…è¿‡æ­¤å¤§å°å°†ä¼šä½¿ç”¨åˆ†ç‰‡å¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:download_retry]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>ä¸‹è½½é‡è¯•æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚æœç¦ç”¨åˆ™ä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸‹è½½è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>æ³¨ï¼šä¸åŒ…å«å­ç›®å½•ã€‚æ”¯æŒç§æœ‰è®¿é—®èµ„æºä¸‹è½½ï¼ŒSDKä¼šè‡ªåŠ¨æºå¸¦é‰´æƒç­¾åã€‚SDKä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†ç‰‡æ–­ç‚¹ç»­ä¼ ä¸‹è½½å¤§æ–‡ä»¶ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Array</span><span class="pl-k">&lt;</span><span class="pl-c1">String</span><span class="pl-k">&gt;</span> <span class="pl-c"># æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„æ•°ç»„</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>files <span class="pl-k">=</span> dir.download_all(<span class="pl-s"><span class="pl-pds">'</span>~/test/path/<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">p</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸‹è½½è¿›åº¦: <span class="pl-pse">#{</span><span class="pl-s1">(p<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>)
<span class="pl-k">end</span></pre></div>

<h5>
<a id="4427-å½“å‰ç›®å½•å±æ€§åˆ·æ–°stat" class="anchor" href="#4427-%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7%E5%88%B7%E6%96%B0stat" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.7 å½“å‰ç›®å½•å±æ€§ï¼ˆåˆ·æ–°ï¼‰ï¼ˆstatï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.stat</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">COS</span>::<span class="pl-c1">COSDir</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.stat.to_hash</pre></div>

<h5>
<a id="4428-æ›´æ–°å½“å‰ç›®å½•å±æ€§upadte" class="anchor" href="#4428-%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7upadte" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.8 æ›´æ–°å½“å‰ç›®å½•å±æ€§ï¼ˆupadteï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.update(biz_attr)</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>dir.update(<span class="pl-s"><span class="pl-pds">'</span>new biz attr<span class="pl-pds">'</span></span>)</pre></div>

<h5>
<a id="4429-åˆ é™¤å½“å‰ç›®å½•delete" class="anchor" href="#4429-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.9 åˆ é™¤å½“å‰ç›®å½•ï¼ˆdeleteï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.delete</pre></div>

<p>æ³¨æ„ï¼šéç©ºç›®å½•æˆ–æ ¹ç›®å½•æ— æ³•åˆ é™¤ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</p>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>dir.delete</pre></div>

<h5>
<a id="44210-åˆ é™¤å½“å‰ç›®å½•æ— å¼‚å¸¸delete" class="anchor" href="#44210-%E5%88%A0%E9%99%A4%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%97%A0%E5%BC%82%E5%B8%B8delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.10 åˆ é™¤å½“å‰ç›®å½•ï¼ˆæ— å¼‚å¸¸ï¼‰ï¼ˆdelete!ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.delete!</pre></div>

<p>æ³¨æ„ï¼šéç©ºç›®å½•æˆ–æ ¹ç›®å½•æ— æ³•åˆ é™¤ï¼Œè¿”å›æ˜¯å¦æˆåŠŸçš„boolå€¼ã€‚</p>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.delete!</pre></div>

<h5>
<a id="44211-åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦ä¸ºç©ºempty" class="anchor" href="#44211-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BAempty" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.11 åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦ä¸ºç©ºï¼ˆempty?ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.empty?</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.empty?</pre></div>

<h5>
<a id="44212-åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦å­˜åœ¨existexists" class="anchor" href="#44212-%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8existexists" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.12 åˆ¤æ–­å½“å‰ç›®å½•æ˜¯å¦å­˜åœ¨ï¼ˆexist?ï¼Œexists?ï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.exist? <span class="pl-c"># åˆ«å exists?</span></pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Boolean</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.exist?</pre></div>

<h5>
<a id="44213-è·å–å½“å‰ç›®å½•ä¸‹çš„objectæ ‘å½¢ç»“æ„tree" class="anchor" href="#44213-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84object%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.13 è·å–å½“å‰ç›®å½•ä¸‹çš„Objectæ ‘å½¢ç»“æ„ï¼ˆtreeï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.tree(options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:depth]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5</td>
<td>å­ç›®å½•æ·±åº¦,é»˜è®¤ä¸º5</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<pre><code>{
    :resource =&gt; Object&lt;COS::COSDir&gt;,
    :children =&gt; [
        {:resource =&gt; Object&lt;COS::COSDir&gt;, :children =&gt; [...]},
        {:resource =&gt; Object&lt;COS::COSFile&gt;, :children =&gt; [...]},
        ...
    ]
}
</code></pre>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>tree <span class="pl-k">=</span> dir.tree
puts tree[<span class="pl-c1">:resource</span>].name
tree[<span class="pl-c1">:children</span>].each <span class="pl-k">do </span>|<span class="pl-smi">r</span>|
  puts r[<span class="pl-c1">:resource</span>].name
<span class="pl-k">end</span></pre></div>

<h5>
<a id="44214-è·å–å½“å‰ç›®å½•ä¸‹çš„hashæ ‘å½¢ç»“æ„hash_tree" class="anchor" href="#44214-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84hash%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84hash_tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.14 è·å–å½“å‰ç›®å½•ä¸‹çš„Hashæ ‘å½¢ç»“æ„ï¼ˆhash_treeï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.hash_tree(options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:depth]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">5</td>
<td>å­ç›®å½•æ·±åº¦,é»˜è®¤ä¸º5</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<pre><code>{
    :resource =&gt; {:name...},
    :children =&gt; [
        {:resource =&gt; {:name...}, :children =&gt; [...]},
        {:resource =&gt; {:name...}, :children =&gt; [...]},
        ...
    ]
}
</code></pre>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>tree <span class="pl-k">=</span> dir.hash_tree
puts tree[<span class="pl-c1">:resource</span>][<span class="pl-c1">:name</span>]
tree[<span class="pl-c1">:children</span>].each <span class="pl-k">do </span>|<span class="pl-smi">r</span>|
  puts r[<span class="pl-c1">:resource</span>][<span class="pl-c1">:name</span>]
<span class="pl-k">end</span>
puts tree.to_json <span class="pl-c"># å¯ç›´æ¥è½¬ä¸ºjson</span></pre></div>

<h5>
<a id="44215-è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°è¯¦æƒ…æ”¯æŒå‰ç¼€æœç´¢list_count" class="anchor" href="#44215-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0%E8%AF%A6%E6%83%85%E6%94%AF%E6%8C%81%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2list_count" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.15 è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°è¯¦æƒ…ï¼ˆæ”¯æŒå‰ç¼€æœç´¢ï¼‰ï¼ˆlist_countï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.list_count(options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:prefix]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>å‰ç¼€æœç´¢</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Hash</span>
{
  <span class="pl-c1">:total</span> =&gt; <span class="pl-c1">5</span>, <span class="pl-c"># ç›®å½•åŠæ–‡ä»¶æ€»æ•°</span>
  <span class="pl-c1">:files</span> =&gt; <span class="pl-c1">2</span>, <span class="pl-c"># æ–‡ä»¶æ€»æ•°</span>
  <span class="pl-c1">:dirs</span> =&gt; <span class="pl-c1">3</span>, <span class="pl-c"># ç›®å½•æ€»æ•°</span>
}</pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.list_count[<span class="pl-c1">:files</span>]</pre></div>

<h5>
<a id="44216-è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°count-size" class="anchor" href="#44216-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E4%B8%AA%E6%95%B0count-size" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.16 è·å–å½“å‰ç›®å½•ä¸‹çš„èµ„æºä¸ªæ•°ï¼ˆcount, sizeï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.count <span class="pl-c"># åˆ«å size</span></pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># ç›®å½•åŠæ–‡ä»¶æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.count</pre></div>

<h5>
<a id="44217-è·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°count_files" class="anchor" href="#44217-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%AA%E6%95%B0count_files" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.17 è·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°ï¼ˆcount_filesï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.count_files</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># æ–‡ä»¶æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.count_files</pre></div>

<h5>
<a id="44218-è·å–å½“å‰ç›®å½•ä¸‹çš„å­ç›®å½•ä¸ªæ•°count_dirs" class="anchor" href="#44218-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E5%AD%90%E7%9B%AE%E5%BD%95%E4%B8%AA%E6%95%B0count_dirs" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.4.2.18 è·å–å½“å‰ç›®å½•ä¸‹çš„å­ç›®å½•ä¸ªæ•°ï¼ˆcount_dirsï¼‰</h5>

<div class="highlight highlight-source-ruby"><pre>dir.count_dirs</pre></div>

<p>è¿”å›ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c1">Integer</span> <span class="pl-c"># ç›®å½•æ€»æ•°</span></pre></div>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts dir.count_dirs</pre></div>

<h3>
<a id="45-ç­¾åæ“ä½œcossignature" class="anchor" href="#45-%E7%AD%BE%E5%90%8D%E6%93%8D%E4%BD%9Ccossignature" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.5 ç­¾åæ“ä½œï¼ˆCOS::Signatureï¼‰</h3>

<p>è…¾è®¯ç§»åŠ¨æœåŠ¡é€šè¿‡ç­¾åæ¥éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§ã€‚å¼€å‘è€…é€šè¿‡å°†ç­¾åæˆæƒç»™å®¢æˆ·ç«¯ï¼Œä½¿å…¶å…·å¤‡ä¸Šä¼ ä¸‹è½½åŠç®¡ç†æŒ‡å®šèµ„æºçš„èƒ½åŠ›ã€‚ç­¾ååˆ†ä¸º<strong>å¤šæ¬¡æœ‰æ•ˆç­¾å</strong>å’Œ<strong>å•æ¬¡æœ‰æ•ˆç­¾å</strong></p>

<p><g-emoji alias="mag" fallback-src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f50d.png">ğŸ”</g-emoji>å…·ä½“é€‚ç”¨åœºæ™¯å‚è§<a href="http://www.qcloud.com/wiki/%E9%89%B4%E6%9D%83%E6%8A%80%E6%9C%AF%E6%9C%8D%E5%8A%A1%E6%96%B9%E6%A1%88#4_.E7.AD.BE.E5.90.8D.E9.80.82.E7.94.A8.E5.9C.BA.E6.99.AF">ç­¾åé€‚ç”¨åœºæ™¯</a></p>

<h4>
<a id="451-è·å–å•æ¬¡æœ‰æ•ˆç­¾åonce" class="anchor" href="#451-%E8%8E%B7%E5%8F%96%E5%8D%95%E6%AC%A1%E6%9C%89%E6%95%88%E7%AD%BE%E5%90%8Donce" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.5.1 è·å–å•æ¬¡æœ‰æ•ˆç­¾åï¼ˆonceï¼‰</h4>

<p>ç­¾åä¸­ç»‘å®šæ–‡ä»¶fileidï¼Œæ­¤ç­¾ååªå¯ä½¿ç”¨ä¸€æ¬¡ï¼Œä¸”åªèƒ½åº”ç”¨äºè¢«ç»‘å®šçš„æ–‡ä»¶ã€‚</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.signature.once(bucket_name, path)
<span class="pl-c"># path ä¸ºæ“ä½œèµ„æºçš„è·¯å¾„</span></pre></div>

<h4>
<a id="452-è·å–å¤šæ¬¡æœ‰æ•ˆç­¾åmultiple" class="anchor" href="#452-%E8%8E%B7%E5%8F%96%E5%A4%9A%E6%AC%A1%E6%9C%89%E6%95%88%E7%AD%BE%E5%90%8Dmultiple" aria-hidden="true"><span class="octicon octicon-link"></span></a>4.5.2 è·å–å¤šæ¬¡æœ‰æ•ˆç­¾åï¼ˆmultipleï¼‰</h4>

<p>ç­¾åä¸­ä¸ç»‘å®šæ–‡ä»¶fileidï¼Œæœ‰æ•ˆæœŸå†…æ­¤ç­¾åå¯å¤šæ¬¡ä½¿ç”¨ï¼Œæœ‰æ•ˆæœŸæœ€é•¿å¯è®¾ç½®ä¸‰ä¸ªæœˆã€‚</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.signature.multiple(bucket_name, expire_seconds)
<span class="pl-c"># expire_seconds ä¸ºä»è·å–æ—¶é—´èµ·å¾—æœ‰æ•ˆæ—¶é—´å•ä½ç§’ï¼Œå¿…é¡»å¤§äº0ã€‚</span></pre></div>

<h2>
<a id="5-åº•å±‚apicosapi" class="anchor" href="#5-%E5%BA%95%E5%B1%82apicosapi" aria-hidden="true"><span class="octicon octicon-link"></span></a>5 åº•å±‚APIï¼ˆCOS::APIï¼‰</h2>

<h3>
<a id="51-åˆ›å»ºç›®å½•create_folder" class="anchor" href="#51-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95create_folder" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.1 åˆ›å»ºç›®å½•(create_folder)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.create_folder(path, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ç›®å½•å±æ€§, ä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<p><code>Hash</code></p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ctime</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">åˆ›å»ºæ—¶é—´Unixæ—¶é—´æˆ³</td>
</tr>
<tr>
<td align="left">resource_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">åˆ›å»ºçš„èµ„æºè·¯å¾„</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.api.create_folder(<span class="pl-s"><span class="pl-pds">"</span>test_dir5<span class="pl-pds">"</span></span>, <span class="pl-c1">biz_attr:</span> <span class="pl-s"><span class="pl-pds">'</span>æµ‹è¯•ç›®å½•5<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="52-ç›®å½•åˆ—è¡¨å‰ç¼€æœç´¢list" class="anchor" href="#52-%E7%9B%AE%E5%BD%95%E5%88%97%E8%A1%A8%E5%89%8D%E7%BC%80%E6%90%9C%E7%B4%A2list" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.2 ç›®å½•åˆ—è¡¨ï¼ˆå‰ç¼€æœç´¢ï¼‰(list)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.list(path, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">å¦</td>
<td>éœ€è¦åˆ—ä¸¾çš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:prefix]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æœç´¢å‰ç¼€ï¼Œå¦‚æœå¡«å†™prefix, åˆ™åˆ—å‡ºå«æ­¤å‰ç¼€çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•</td>
</tr>
<tr>
<td align="left">options[:num]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">20</td>
<td></td>
</tr>
<tr>
<td align="left">options[:pattern]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:both</td>
<td>è·å–æ¨¡å¼ï¼Œ:dir_only åªè·å–ç›®å½•, :file_only åªè·å–æ–‡ä»¶, é»˜è®¤ä¸º :both å…¨éƒ¨è·å–</td>
</tr>
<tr>
<td align="left">options[:order]</td>
<td align="center">Symbol</td>
<td align="center">å¦</td>
<td align="center">:asc</td>
<td>æ’åºæ–¹å¼ :asc æ­£åº, :desc å€’åº é»˜è®¤ä¸º :asc</td>
</tr>
<tr>
<td align="left">options[:context]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç©º</td>
<td>è‹¥éœ€è¦ç¿»é¡µï¼Œéœ€è¦å°†å‰ä¸€é¡µè¿”å›å€¼ä¸­çš„contexté€ä¼ åˆ°å‚æ•°ä¸­</td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<p><code>Hash</code></p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">context</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">é€ä¼ å­—æ®µ,ç”¨äºç¿»é¡µ,éœ€è¦å¾€å‰/å¾€åç¿»é¡µåˆ™é€ä¼ å›æ¥</td>
</tr>
<tr>
<td align="left">has_more</td>
<td align="center">Boolean</td>
<td align="center">æ˜¯</td>
<td align="center">æ˜¯å¦æœ‰å†…å®¹å¯ä»¥ç»§ç»­å¾€å‰/å¾€åç¿»é¡µ</td>
</tr>
<tr>
<td align="left">dircount</td>
<td align="center">Integer</td>
<td align="center">æ˜¯</td>
<td align="center">å­ç›®å½•æ•°é‡(æ€»)</td>
</tr>
<tr>
<td align="left">filecount</td>
<td align="center">Integer</td>
<td align="center">æ˜¯</td>
<td align="center">å­æ–‡ä»¶æ•°é‡(æ€»)</td>
</tr>
<tr>
<td align="left">infos</td>
<td align="center">Array</td>
<td align="center">æ˜¯</td>
<td align="center">åˆ—è¡¨ç»“æœ(å¯èƒ½ä¸ºç©º)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç›®å½•å/æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç›®å½•/æ–‡ä»¶å±æ€§ï¼Œä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :filesize</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶å¤§å°(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :filelen</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶å·²ä¼ è¾“å¤§å°(é€šè¿‡ä¸filesizeå¯¹æ¯”å¯çŸ¥æ–‡ä»¶ä¼ è¾“è¿›åº¦,å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :sha</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶sha1(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :ctime</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">åˆ›å»ºæ—¶é—´(Unixæ—¶é—´æˆ³)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :mtime</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ä¿®æ”¹æ—¶é—´(Unixæ—¶é—´æˆ³)</td>
</tr>
<tr>
<td align="left">å­å±æ€§ :access_url</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç”Ÿæˆçš„èµ„æºå¯è®¿é—®çš„url(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.api.list(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>, <span class="pl-c1">pattern:</span> <span class="pl-c1">:dir_only</span>, <span class="pl-c1">order:</span> <span class="pl-c1">:desc</span>, <span class="pl-c1">prefix:</span> <span class="pl-s"><span class="pl-pds">'</span>abc<span class="pl-pds">'</span></span>, <span class="pl-c1">context:</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="53-ä¸Šä¼ æ–‡ä»¶å®Œæ•´ä¸Šä¼ upload" class="anchor" href="#53-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%AE%8C%E6%95%B4%E4%B8%8A%E4%BC%A0upload" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.3 ä¸Šä¼ æ–‡ä»¶ï¼ˆå®Œæ•´ä¸Šä¼ ï¼‰(upload)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.upload(path, file_name, file_src, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ç›®å½•è·¯å¾„, å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">file_name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>å­˜å‚¨æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">file_src</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–‡ä»¶å±æ€§, ä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<p><code>Hash</code></p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">access_url</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç”Ÿæˆçš„æ–‡ä»¶ä¸‹è½½url</td>
</tr>
<tr>
<td align="left">url</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ“ä½œæ–‡ä»¶çš„url</td>
</tr>
<tr>
<td align="left">resource_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">èµ„æºè·¯å¾„</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.api.upload(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>file1.txt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test.txt<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="54-ä¸Šä¼ æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ upload_slice" class="anchor" href="#54-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0upload_slice" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.4 ä¸Šä¼ æ–‡ä»¶ï¼ˆåˆ†ç‰‡ä¸Šä¼ ï¼‰(upload_slice)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.upload_slice(path, file_name, file_src, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ç›®å½•è·¯å¾„, å¦‚: '/', 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'</td>
</tr>
<tr>
<td align="left">file_name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>å­˜å‚¨æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">file_src</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:biz_attr]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸šåŠ¡å±æ€§</td>
</tr>
<tr>
<td align="left">options[:disable_cpt]</td>
<td align="center">Boolean</td>
<td align="center">å¦</td>
<td align="center">false</td>
<td>æ˜¯å¦ç¦ç”¨checkpointï¼Œå¦‚ç¦ç”¨ä»å¯é€šè¿‡æœåŠ¡ç«¯è¿›è¡Œæ–­ç‚¹ç»­ä¼ </td>
</tr>
<tr>
<td align="left">options[:threads]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">10</td>
<td>å¤šçº¿ç¨‹ä¸Šä¼ çº¿ç¨‹æ•°</td>
</tr>
<tr>
<td align="left">options[:slice_size]</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">3 * 1024 * 1024</td>
<td>è®¾ç½®åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°ã€‚é»˜è®¤ä¸º3 MB, ç›®å‰æœåŠ¡ç«¯æœ€å¤§é™åˆ¶ä¹Ÿä¸º3MBã€‚</td>
</tr>
<tr>
<td align="left">options[:cpt_file]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>æ–­ç‚¹ç»­ä¼ çš„checkpointæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
<tr>
<td align="left">yield</td>
<td align="center">Float</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>ä¸Šä¼ è¿›åº¦ç™¾åˆ†æ¯”å›è°ƒ, è¿›åº¦å€¼æ˜¯ä¸€ä¸ª0-1ä¹‹é—´çš„å°æ•°</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<p><code>Hash</code></p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">access_url</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç”Ÿæˆçš„æ–‡ä»¶ä¸‹è½½url</td>
</tr>
<tr>
<td align="left">url</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ“ä½œæ–‡ä»¶çš„url</td>
</tr>
<tr>
<td align="left">resource_path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">èµ„æºè·¯å¾„</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.api.upload_slice(<span class="pl-s"><span class="pl-pds">'</span>/test<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>file1.txt<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test.txt<span class="pl-pds">'</span></span>) <span class="pl-k">do </span>|<span class="pl-smi">pr</span>|
  puts <span class="pl-s"><span class="pl-pds">"</span>ä¸Šä¼ è¿›åº¦ <span class="pl-pse">#{</span><span class="pl-s1">(pr<span class="pl-k">*</span><span class="pl-c1">100</span>).round(<span class="pl-c1">2</span>)</span><span class="pl-pse"><span class="pl-s1">}</span></span>%<span class="pl-pds">"</span></span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="55-æ›´æ–°æ–‡ä»¶ç›®å½•å±æ€§update" class="anchor" href="#55-%E6%9B%B4%E6%96%B0%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7update" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.5 æ›´æ–°æ–‡ä»¶ã€ç›®å½•å±æ€§(update)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.update(path, biz_attr, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>ç›®å½•å±æ€§, ä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼šæ— </p>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.update(<span class="pl-s"><span class="pl-pds">'</span>test/file1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>new biz attr<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="56-åˆ é™¤æ–‡ä»¶ç›®å½•delete" class="anchor" href="#56-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95delete" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.6 åˆ é™¤æ–‡ä»¶ã€ç›®å½•(delete)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.delete(path, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼šæ— </p>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.delete(<span class="pl-s"><span class="pl-pds">'</span>test/file1<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="57-è·å–æ–‡ä»¶æˆ–ç›®å½•å±æ€§stat" class="anchor" href="#57-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95%E5%B1%9E%E6%80%A7stat" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.7 è·å–æ–‡ä»¶æˆ–ç›®å½•å±æ€§(stat)</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.update(path, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">path</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>éœ€è¦åˆ›å»ºçš„ç›®å½•è·¯å¾„, å¦‚: 'path1', 'path1/path2', sdkä¼šè¡¥é½æœ«å°¾çš„ '/'ã€‚</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center"></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
</tbody>
</table>

<p>è¿”å›ï¼š</p>

<p><code>Hash</code></p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">name</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç›®å½•å/æ–‡ä»¶å</td>
</tr>
<tr>
<td align="left">biz_attr</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ç›®å½•/æ–‡ä»¶å±æ€§ï¼Œä¸šåŠ¡ç«¯ç»´æŠ¤</td>
</tr>
<tr>
<td align="left">filesize</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶å¤§å°(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">filelen</td>
<td align="center">Integer</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶å·²ä¼ è¾“å¤§å°(é€šè¿‡ä¸filesizeå¯¹æ¯”å¯çŸ¥æ–‡ä»¶ä¼ è¾“è¿›åº¦,å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">sha</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ–‡ä»¶sha1(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
<tr>
<td align="left">ctime</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">åˆ›å»ºæ—¶é—´(Unixæ—¶é—´æˆ³)</td>
</tr>
<tr>
<td align="left">mtime</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">ä¿®æ”¹æ—¶é—´(Unixæ—¶é—´æˆ³)</td>
</tr>
<tr>
<td align="left">access_url</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">ç”Ÿæˆçš„èµ„æºå¯è®¿é—®çš„url(å½“ç±»å‹ä¸ºæ–‡ä»¶æ—¶è¿”å›)</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre>puts <span class="pl-smi">@client</span>.api.stat(<span class="pl-s"><span class="pl-pds">'</span>/test/file<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="58ä¸‹è½½æ–‡ä»¶" class="anchor" href="#58%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.8ä¸‹è½½æ–‡ä»¶</h3>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.download(access_url, file_store, options <span class="pl-k">=</span> {})</pre></div>

<p>å‚æ•°ï¼š</p>

<table>
<thead>
<tr>
<th align="left">å‚æ•°å</th>
<th align="center">ç±»å‹</th>
<th align="center">å¿…é¡»</th>
<th align="center">é»˜è®¤å€¼</th>
<th>å‚æ•°æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">access_url</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>èµ„æºçš„ä¸‹è½½URLåœ°å€å¯ä»¥ä»list,statæ¥å£ä¸­è·å–</td>
</tr>
<tr>
<td align="left">file_store</td>
<td align="center">String</td>
<td align="center">æ˜¯</td>
<td align="center">æ— </td>
<td>æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„</td>
</tr>
<tr>
<td align="left">options</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td></td>
</tr>
<tr>
<td align="left">options[:bucket]</td>
<td align="center">String</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>bucketåç§°ï¼Œå¦‚æœªé…ç½®default_bucketåˆ™å¿…é¡»åˆ¶å®š</td>
</tr>
<tr>
<td align="left">options[:headers]</td>
<td align="center">Hash</td>
<td align="center">å¦</td>
<td align="center">æ— </td>
<td>è®¾ç½®ä¸‹è½½è¯·æ±‚å¤´,å¦‚:rang</td>
</tr>
</tbody>
</table>

<p>ç¤ºä¾‹ï¼š</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-smi">@client</span>.api.download(<span class="pl-s"><span class="pl-pds">'</span>/test/file<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~/test.txt<span class="pl-pds">'</span></span>)</pre></div>

<h2>
<a id="6-cliå‘½ä»¤è¡Œå·¥å…·" class="anchor" href="#6-cli%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7" aria-hidden="true"><span class="octicon octicon-link"></span></a>6 CLIå‘½ä»¤è¡Œå·¥å…·</h2>

<p>SDKæä¾›äº†ä¸€å¥—åŒ…å«æ‰€æœ‰APIè°ƒç”¨çš„CLIå·¥å…·ï¼Œæ–¹ä¾¿å¼€å‘è€…æ›´å¥½çš„è°ƒè¯•ä¸æ›´ä¾¿æ·çš„ä½¿ç”¨COSã€‚</p>

<p>è·å–CLIæŒ‡ä»¤åˆ—è¡¨ï¼š</p>

<div class="highlight highlight-source-shell"><pre>$ cos

COS Ruby SDK CLI commands:
  cos count [PATH]                           <span class="pl-c"># è·å–æ–‡ä»¶åŠç›®å½•æ•°</span>
  cos count_dirs [PATH]                      <span class="pl-c"># è·å–ç›®å½•æ•°</span>
  cos count_files [PATH]                     <span class="pl-c"># è·å–æ–‡ä»¶æ•°</span>
  cos create_folder [PATH]                   <span class="pl-c"># åˆ›å»ºç›®å½•</span>
  cos delete [PATH]                          <span class="pl-c"># åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶</span>
  cos download [PATH] [FILE_STORE]           <span class="pl-c"># ä¸‹è½½æ–‡ä»¶(å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†ç‰‡ä¸‹è½½,æ”¯æŒå¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ )</span>
  cos download_all [PATH] [FILE_STORE_PATH]  <span class="pl-c"># ä¸‹è½½ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶(ä¸å«å­ç›®å½•)</span>
  cos is_exist [PATH]                        <span class="pl-c"># åˆ¤æ–­æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</span>
  cos <span class="pl-c1">help</span> [COMMAND]                         <span class="pl-c"># è·å–æŒ‡ä»¤çš„ä½¿ç”¨å¸®åŠ©</span>
  cos init                                   <span class="pl-c"># åˆ›å»ºé»˜è®¤é…ç½®æ–‡ä»¶</span>
  cos is_complete [PATH]                     <span class="pl-c"># åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸Šä¼ å®Œæ•´</span>
  cos is_empty [PATH]                        <span class="pl-c"># åˆ¤æ–­ç›®å½•æ˜¯å¦ä¸ºç©º</span>
  cos list [PATH]                            <span class="pl-c"># è·å–ç›®å½•åˆ—è¡¨</span>
  cos sign_multi [EXPIRE]                    <span class="pl-c"># ç”Ÿæˆå¤šæ¬¡å¯ç”¨ç­¾å</span>
  cos sign_once [PATH]                       <span class="pl-c"># ç”Ÿæˆå•æ¬¡å¯ç”¨ç­¾å</span>
  cos stat [PATH]                            <span class="pl-c"># è·å–ç›®å½•æˆ–æ–‡ä»¶ä¿¡æ¯</span>
  cos tree [PATH]                            <span class="pl-c"># æ˜¾ç¤ºæ ‘å½¢ç»“æ„</span>
  cos update [PATH] [BIZ_ATTR]               <span class="pl-c"># æ›´æ–°ä¸šåŠ¡å±æ€§</span>
  cos upload [PATH] [FILE_NAME] [FILE_SRC]   <span class="pl-c"># ä¸Šä¼ æ–‡ä»¶(å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†ç‰‡ä¸Šä¼ ,æ”¯æŒå¤šçº¿ç¨‹æ–­ç‚¹ç»­ä¼ )</span>
  cos upload_all [PATH] [FILE_SRC_PATH]      <span class="pl-c"># ä¸Šä¼ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶(ä¸å«å­ç›®å½•)</span>
  cos url [PATH]                             <span class="pl-c"># è·å–æ–‡ä»¶çš„è®¿é—®URL</span>

Options:
  -c, [--config<span class="pl-k">=</span>CONFIG]  <span class="pl-c"># åŠ è½½é…ç½®æ–‡ä»¶</span>
                         <span class="pl-c"># Default: ~/.cos.yml</span>
  -b, [--bucket<span class="pl-k">=</span>BUCKET]  <span class="pl-c"># æŒ‡å®šBucket</span></pre></div>

<p>è·å–æŒ‡ä»¤çš„è¯¦ç»†å‚æ•°å¦‚ï¼š</p>

<div class="highlight highlight-source-shell"><pre>$ cos <span class="pl-c1">help</span> upload

Usage:
  cos upload [PATH] [FILE_NAME] [FILE_SRC]

Options:
  -r, [--biz-attr<span class="pl-k">=</span>BIZ_ATTR]                              <span class="pl-c"># ä¸šåŠ¡å±æ€§</span>
  -m, [--min-slice-size<span class="pl-k">=</span>bytes]                           <span class="pl-c"># æœ€å°å®Œæ•´ä¸Šä¼ å¤§å°</span>
  -f, [--auto-create-folder], [--no-auto-create-folder]  <span class="pl-c"># è‡ªåŠ¨åˆ›å»ºç›®å½•</span>
  -d, [--disable-cpt], [--no-disable-cpt]                <span class="pl-c"># ç¦ç”¨æ–­ç‚¹ç»­ä¼ (åˆ†ç‰‡ä¸Šä¼ æ—¶æœ‰æ•ˆ)</span>
  -t, [--threads<span class="pl-k">=</span>N]                                      <span class="pl-c"># çº¿ç¨‹æ•°(åˆ†ç‰‡ä¸Šä¼ æ—¶æœ‰æ•ˆ)</span>
  -n, [--upload-retry<span class="pl-k">=</span>N]                                 <span class="pl-c"># é‡è¯•æ¬¡æ•°(åˆ†ç‰‡ä¸Šä¼ æ—¶æœ‰æ•ˆ)</span>
  -s, [--slice-size<span class="pl-k">=</span>N]                                   <span class="pl-c"># åˆ†ç‰‡ä¸Šä¼ æ—¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°(åˆ†ç‰‡ä¸Šä¼ æ—¶æœ‰æ•ˆ)</span>
  -e, [--cpt-file<span class="pl-k">=</span>CPT_FILE]                              <span class="pl-c"># æŒ‡å®šæ–­ç‚¹ç»­ä¼ è®°å½•(åˆ†ç‰‡ä¸Šä¼ æ—¶æœ‰æ•ˆ)</span>
  -c, [--config<span class="pl-k">=</span>CONFIG]                                  <span class="pl-c"># åŠ è½½é…ç½®æ–‡ä»¶</span>
                                                         <span class="pl-c"># Default: ~/.cos.yml</span>
  -b, [--bucket<span class="pl-k">=</span>BUCKET]                                  <span class="pl-c"># æŒ‡å®šBucket</span>

ä¸Šä¼ æ–‡ä»¶(å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†ç‰‡ä¸Šä¼ ,æ”¯æŒå¤šçº¿ç¨‹ä¸Šä¼ ,æ–­ç‚¹ç»­ä¼ )</pre></div>

<p>åˆå§‹åŒ–åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š(é»˜è®¤åˆ›å»ºäº<code>~/.cos.yml</code>)</p>

<div class="highlight highlight-source-shell"><pre>$ cos init</pre></div>

<p>ä½¿ç”¨CLI:</p>

<div class="highlight highlight-source-shell"><pre>$ cos upload path/path2 file1 <span class="pl-k">~</span>/file1</pre></div>

<h2>
<a id="7-è¿è¡Œæµ‹è¯•" class="anchor" href="#7-%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>7 è¿è¡Œæµ‹è¯•</h2>

<pre><code>rspec
</code></pre>

<p>æˆ–</p>

<pre><code>bundle exec rake spec
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/RaymondChou/cos-ruby-sdk">Cos-ruby-sdk</a> is maintained by <a href="https://github.com/RaymondChou">RaymondChou</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
